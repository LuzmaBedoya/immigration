<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LMBI Immigration - Solicitud de Visa Canadiense</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Colores Aguamarina */
            --aqua-primary: #20B2AA;
            --aqua-dark: #178F87;
            --aqua-light: #5FDED6;
            --aqua-pale: #B2F5EA;
            --aqua-bg: #E6FFFA;
            
            /* Colores Terracota (complementarios) */
            --terracota-primary: #C85A4F;
            --terracota-dark: #A74238;
            --terracota-light: #E8998D;
            --terracota-pale: #F4DDD9;
            --terracota-bg: #FFF8F6;
            
            /* Colores Base */
            --cream: #FAF7F5;
            --warm-gray: #718096;
            --dark-text: #2D3748;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--aqua-bg) 0%, var(--cream) 100%);
            min-height: 100vh;
            color: var(--dark-text);
            line-height: 1.6;
        }

        /* Header con info del aplicante */
        header {
            background: linear-gradient(120deg, var(--aqua-dark) 0%, var(--aqua-primary) 100%);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 4px 20px rgba(32, 178, 170, 0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 0.25rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }

        .logo p {
            font-size: 0.85rem;
            opacity: 0.95;
            font-weight: 300;
        }

        /* Info del aplicante en header */
        .applicant-info {
            display: none;
            align-items: center;
            gap: 1.5rem;
            font-size: 0.85rem;
            flex-wrap: wrap;
        }

        .applicant-info.show {
            display: flex;
        }

        .applicant-info-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        /* Barra de progreso global */
        .global-progress {
            background: white;
            padding: 0.8rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .global-progress-inner {
            max-width: 1400px;
            margin: 0 auto;
        }

        .progress-bar-container {
            background: #E2E8F0;
            height: 8px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--aqua-dark), var(--aqua-primary));
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            font-size: 0.85rem;
            color: var(--warm-gray);
            text-align: center;
            font-weight: 500;
        }

        /* Navegaci√≥n r√°pida */
        .quick-nav {
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
            margin-bottom: 1.5rem;
            display: none;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .quick-nav.show {
            display: flex;
        }

        .quick-nav-steps {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            flex: 1;
        }

        .quick-nav-btn {
            padding: 0.5rem 0.8rem;
            background: var(--cream);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s ease;
            color: var(--dark-text);
            font-family: 'Poppins', sans-serif;
            white-space: nowrap;
        }

        .quick-nav-btn:hover {
            border-color: var(--aqua-light);
            background: var(--aqua-pale);
        }

        .quick-nav-btn.active {
            background: linear-gradient(135deg, var(--aqua-primary), var(--aqua-light));
            color: white;
            border-color: var(--aqua-primary);
        }

        .home-btn {
            padding: 0.6rem 1.2rem;
            background: white;
            border: 2px solid var(--aqua-primary);
            border-radius: 8px;
            color: var(--aqua-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-family: 'Poppins', sans-serif;
        }

        .home-btn:hover {
            background: var(--aqua-primary);
            color: white;
        }

        /* Language Selector */
        .lang-selector {
            position: relative;
        }

        .lang-btn {
            background: rgba(255,255,255,0.15);
            border: 1.5px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            transition: all 0.3s ease;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.25);
        }

        .lang-dropdown {
            position: absolute;
            right: 0;
            top: calc(100% + 0.5rem);
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            overflow: hidden;
            display: none;
            min-width: 180px;
        }

        .lang-dropdown.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .lang-option {
            padding: 0.9rem 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            font-weight: 500;
            color: var(--dark-text);
        }

        .lang-option:hover {
            background: var(--terracota-pale);
        }

        .lang-option.active {
            background: var(--terracota-light);
            color: white;
            font-weight: 600;
        }

        /* Container */
        .container {
            max-width: 1300px;
            margin: 2.5rem auto;
            padding: 0 2rem;
        }

        /* Horizontal Navigation Bar (for steps 1-5) */
        .horizontal-nav {
            display: none;
            background: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .horizontal-nav.show {
            display: block;
        }

        .horizontal-steps {
            display: flex;
            gap: 0.5rem;
            min-width: max-content;
        }

        .horizontal-step {
            flex: 1;
            min-width: 140px;
            padding: 0.8rem 1.2rem;
            background: var(--cream);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .horizontal-step:hover {
            background: var(--terracota-pale);
            border-color: var(--terracota-light);
        }

        .horizontal-step.active {
            background: linear-gradient(135deg, var(--terracota-primary), var(--terracota-light));
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(200, 90, 79, 0.3);
        }

        .horizontal-step.completed {
            background: white;
            border-color: var(--terracota-primary);
        }

        .horizontal-step-number {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .horizontal-step-label {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .horizontal-step.active .horizontal-step-number,
        .horizontal-step.active .horizontal-step-label {
            opacity: 1;
        }

        /* Card */
        .card {
            background: white;
            padding: 2.5rem;
            border-radius: 16px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
            margin-bottom: 2rem;
        }

        .card-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--dark-text);
            margin-bottom: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        /* Step Content */
        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Welcome Page - Process Flow */
        .welcome-intro {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 2rem;
            color: var(--warm-gray);
        }

        .process-flow {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin: 2.5rem 0;
        }

        .process-card {
            background: linear-gradient(135deg, #FFFFFF, var(--cream));
            border: 2px solid var(--aqua-pale);
            border-radius: 12px;
            padding: 2rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .process-card:hover {
            border-color: var(--aqua-primary);
            box-shadow: 0 8px 25px rgba(32, 178, 170, 0.2);
            transform: translateY(-5px);
        }

        .process-number {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--aqua-primary), var(--aqua-light));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.4rem;
            margin: 0 auto 1rem;
            box-shadow: 0 4px 15px rgba(32, 178, 170, 0.3);
        }

        .process-card h4 {
            font-size: 1.05rem;
            color: var(--dark-text);
            margin-bottom: 0.6rem;
            font-weight: 600;
        }

        .process-card p {
            font-size: 0.88rem;
            color: var(--warm-gray);
            line-height: 1.6;
        }

        /* Alerts */
        .alert {
            padding: 1.8rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            border-left: 4px solid;
        }

        .alert-warning {
            background: #FFF8E1;
            border-color: #FFB74D;
            color: #E65100;
        }

        .alert-info {
            background: #E3F2FD;
            border-color: #64B5F6;
            color: #0D47A1;
        }

        .alert-success {
            background: #E8F5E9;
            border-color: #81C784;
            color: #1B5E20;
        }

        .alert h3 {
            margin-bottom: 1rem;
            font-size: 1.15rem;
            font-weight: 600;
        }

        .alert p, .alert ul {
            line-height: 1.8;
        }

        .alert ul {
            list-style: none;
            padding: 0;
        }

        .alert li {
            margin-bottom: 1rem;
            padding-left: 2rem;
            position: relative;
        }

        .alert-info li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #1976D2;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .alert a {
            color: var(--terracota-primary);
            font-weight: 600;
            text-decoration: none;
        }

        .alert a:hover {
            text-decoration: underline;
        }

        /* Selection Cards */
        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .selection-card {
            border: 2px solid var(--aqua-pale);
            border-radius: 12px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .selection-card:hover {
            border-color: var(--aqua-primary);
            box-shadow: 0 8px 25px rgba(32, 178, 170, 0.15);
            transform: translateY(-3px);
        }

        .selection-card.selected {
            border-color: var(--aqua-dark);
            background: linear-gradient(135deg, var(--aqua-pale), #FFFFFF);
            box-shadow: 0 8px 25px rgba(32, 178, 170, 0.25);
        }

        .selection-card h3 {
            font-size: 1.2rem;
            color: var(--dark-text);
            margin-bottom: 0.7rem;
            font-weight: 600;
        }

        .selection-card p {
            font-size: 0.95rem;
            color: var(--warm-gray);
            line-height: 1.6;
        }

        /* Document List */
        .doc-list {
            background: var(--cream);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
        }

        .doc-list h3 {
            color: var(--terracota-dark);
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .doc-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            margin-bottom: 0.8rem;
            background: white;
            border-radius: 10px;
            border-left: 4px solid var(--terracota-primary);
            transition: all 0.3s ease;
        }

        .doc-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateX(3px);
        }

        .doc-number {
            background: linear-gradient(135deg, var(--terracota-primary), var(--terracota-light));
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .doc-content h4 {
            font-size: 1rem;
            color: var(--dark-text);
            margin-bottom: 0.4rem;
            font-weight: 600;
        }

        .doc-content p {
            font-size: 0.88rem;
            color: var(--warm-gray);
            line-height: 1.6;
        }

        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.3rem;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            display: block;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--dark-text);
            margin-bottom: 0.6rem;
        }

        .form-group label .required {
            color: var(--terracota-primary);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 2px solid var(--terracota-pale);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--terracota-primary);
            box-shadow: 0 0 0 3px rgba(200, 90, 79, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* Upload */
        .upload-grid {
            display: grid;
            gap: 1.8rem;
        }

        .upload-section h4 {
            color: var(--dark-text);
            margin-bottom: 1rem;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .upload-area {
            border: 2px dashed var(--terracota-pale);
            border-radius: 12px;
            padding: 2.5rem;
            text-align: center;
            cursor: pointer;
            background: var(--cream);
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: var(--terracota-primary);
            background: var(--terracota-pale);
        }

        .upload-area.has-file {
            border-color: #4CAF50;
            background: #E8F5E9;
            border-style: solid;
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 0.7rem;
        }

        .upload-text {
            font-size: 0.95rem;
            color: var(--warm-gray);
        }

        .file-name {
            margin-top: 0.8rem;
            font-size: 0.9rem;
            color: #2E7D32;
            font-weight: 600;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 2.5rem;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.7rem;
            font-family: 'Poppins', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--aqua-primary), var(--aqua-light));
            color: white;
            box-shadow: 0 4px 15px rgba(32, 178, 170, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--aqua-dark), var(--aqua-primary));
            box-shadow: 0 6px 20px rgba(32, 178, 170, 0.4);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--cream);
            color: var(--dark-text);
            border: 2px solid var(--terracota-pale);
        }

        .btn-secondary:hover {
            background: var(--terracota-pale);
            border-color: var(--terracota-primary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid var(--terracota-pale);
            border-top: 4px solid var(--terracota-primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        /* Print Styles */
        @media print {
            @page {
                size: letter;
                margin: 1.5cm;
            }
            
            body * {
                visibility: hidden;
            }
            
            #printableChecklist, 
            #printableChecklist * {
                visibility: visible;
            }
            
            #printableChecklist {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background: white;
                padding: 0;
            }
            
            .no-print {
                display: none !important;
            }
            
            /* Evitar que se corten elementos al imprimir */
            * {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }

            .applicant-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .process-flow {
                grid-template-columns: 1fr;
            }

            .quick-nav {
                flex-direction: column;
            }

            .quick-nav-steps {
                width: 100%;
                flex-direction: column;
            }

            .quick-nav-btn {
                width: 100%;
                text-align: left;
                padding: 0.7rem 1rem;
            }

            .home-btn {
                width: 100%;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (min-width: 769px) and (max-width: 1024px) {
            .process-flow {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <h1>üçÅ LMBI Immigration</h1>
                <p>Solicitud de Visa de Turismo Canadiense</p>
            </div>
            <div class="applicant-info" id="applicantInfo">
                <div class="applicant-info-item">
                    <span>üë§</span>
                    <span id="headerName">-</span>
                </div>
                <div class="applicant-info-item">
                    <span>üìß</span>
                    <span id="headerEmail">-</span>
                </div>
                <div class="applicant-info-item">
                    <span>üì±</span>
                    <span id="headerPhone">-</span>
                </div>
            </div>
            <div class="lang-selector">
                <button class="lang-btn" id="langBtn">
                    <span class="lang-current">üá™üá∏ Espa√±ol</span>
                    <span>‚ñº</span>
                </button>
                <div class="lang-dropdown" id="langDropdown">
                    <div class="lang-option active" data-lang="es">üá™üá∏ Espa√±ol</div>
                    <div class="lang-option" data-lang="en">üá¨üáß English</div>
                    <div class="lang-option" data-lang="fr">üá´üá∑ Fran√ßais</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Barra de Progreso Global -->
    <div class="global-progress">
        <div class="global-progress-inner">
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="globalProgressBar" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="progressText">Paso 0 de 6: Bienvenida</div>
        </div>
    </div>

    <div class="container">
        <!-- Navegaci√≥n R√°pida -->
        <div class="quick-nav" id="quickNav">
            <div class="quick-nav-steps">
                <button class="quick-nav-btn" onclick="goToStep(1)" data-step="1">Paso 1: Tipo de Solicitud</button>
                <button class="quick-nav-btn" onclick="goToStep(2)" data-step="2">Paso 2: Documentos Requeridos</button>
                <button class="quick-nav-btn" onclick="goToStep(3)" data-step="3">Paso 3: Subir Documentos</button>
                <button class="quick-nav-btn" onclick="goToStep(4)" data-step="4">Paso 4: Informaci√≥n Personal</button>
                <button class="quick-nav-btn" onclick="goToStep(5)" data-step="5">Paso 5: Motivo del Viaje</button>
                <button class="quick-nav-btn" onclick="goToStep(6)" data-step="6">Paso 6: Revisi√≥n y Env√≠o</button>
            </div>
            <button class="home-btn" onclick="goToStep(0)">üè† Inicio</button>
        </div>
        <!-- Welcome Page (Step 0) -->
        <div class="step-content active" id="stepWelcome">
            <div class="card">
                <h2 class="card-title">üè† Bienvenido a LMBI Immigration</h2>
                
                <p class="welcome-intro">
                    Le damos la bienvenida a nuestro portal de solicitud de visa de turismo canadiense. 
                    Estamos aqu√≠ para guiarle en cada paso del proceso de manera clara y profesional.
                </p>

                <div class="alert alert-warning">
                    <h3>‚ö†Ô∏è Informaci√≥n Importante - IRCC</h3>
                    <p>
                        <strong>Nota Importante:</strong> La decisi√≥n de aprobar o rechazar una solicitud de visa 
                        es exclusivamente responsabilidad de los Agentes de Inmigraci√≥n de <strong>IRCC</strong> 
                        (Immigration, Refugees and Citizenship Canada). LMBI Immigration proporciona asistencia 
                        profesional en la preparaci√≥n de documentos, pero no puede garantizar la aprobaci√≥n de la visa.
                    </p>
                    <p style="margin-top: 1rem;">
                        En caso de duda o para informaci√≥n oficial, siempre debe referirse a la p√°gina oficial de IRCC: 
                        <a href="https://www.canada.ca/en/immigration-refugees-citizenship.html" target="_blank">www.canada.ca</a>
                    </p>
                </div>

                <h3 style="font-size: 1.3rem; color: var(--terracota-dark); margin: 2.5rem 0 1.5rem; font-weight: 700;">
                    üìã Proceso de Solicitud
                </h3>
                <p style="color: var(--warm-gray); margin-bottom: 1.5rem;">
                    Haga clic en cada paso para navegar directamente a esa secci√≥n:
                </p>

                <div class="process-flow">
                    <div class="process-card" onclick="goToStep(1)">
                        <div class="process-number">1</div>
                        <h4>Tipo de Solicitud</h4>
                        <p>Seleccione su situaci√≥n actual</p>
                    </div>
                    <div class="process-card" onclick="goToStep(2)">
                        <div class="process-number">2</div>
                        <h4>Documentos Requeridos</h4>
                        <p>Revise la lista completa de documentos</p>
                    </div>
                    <div class="process-card" onclick="goToStep(3)">
                        <div class="process-number">3</div>
                        <h4>Subir Documentos</h4>
                        <p>Suba todos los archivos requeridos</p>
                    </div>
                    <div class="process-card" onclick="goToStep(4)">
                        <div class="process-number">4</div>
                        <h4>Informaci√≥n Personal</h4>
                        <p>Complete el formulario detallado</p>
                    </div>
                    <div class="process-card" onclick="goToStep(5)">
                        <div class="process-number">5</div>
                        <h4>Motivo del Viaje</h4>
                        <p>Describa su viaje a Canad√°</p>
                    </div>
                    <div class="process-card" onclick="goToStep(6)">
                        <div class="process-number">6</div>
                        <h4>Revisi√≥n y Env√≠o</h4>
                        <p>Revise y env√≠e su solicitud</p>
                    </div>
                </div>

                <div class="alert alert-info">
                    <h3>üí° Aspectos Importantes a Considerar</h3>
                    <ul>
                        <li>
                            <strong>Documentos Completos:</strong> Recuerde que es importante tener todos los documentos 
                            completos en el momento de enviar, de lo contrario, el proceso de realizaci√≥n de la visa 
                            podr√≠a tomar m√°s tiempo.
                        </li>
                        <li>
                            <strong>Arraigo en su Pa√≠s:</strong> Es importante tener en cuenta que el Gobierno de Canad√° 
                            tiene muy en cuenta el arraigo que usted pueda tener en su pa√≠s (familiar, propiedades, 
                            trabajo, empresa, etc.).
                        </li>
                        <li>
                            <strong>Aspectos Financieros:</strong> Los aspectos financieros son muy tenidos en cuenta. 
                            Tenga en cuenta que las <strong>tarjetas de cr√©dito NO son consideradas como activos</strong> 
                            para el gobierno de Canad√°.
                        </li>
                        <li>
                            <strong>Honestidad:</strong> Es importante siempre decir la verdad en toda la aplicaci√≥n. 
                            La falsificaci√≥n de informaci√≥n puede resultar en la prohibici√≥n permanente de ingresar a Canad√°.
                        </li>
                    </ul>
                </div>

                <div class="alert alert-success" style="text-align: center; margin: 2.5rem 0; background: linear-gradient(135deg, #E8F5E9, #C8E6C9); border-left: 5px solid #4CAF50;">
                    <h3 style="margin-bottom: 1rem; color: #2E7D32; font-size: 1.4rem;">üì• Descargue su Checklist de Documentos</h3>
                    <p style="margin-bottom: 1.5rem; font-size: 1.05rem; color: #1B5E20; line-height: 1.7;">
                        <strong>¬°Importante!</strong> Antes de comenzar su solicitud, descargue la lista completa de documentos 
                        requeridos para su tipo de aplicaci√≥n. Esto le permitir√° preparar todo lo necesario con anticipaci√≥n 
                        y completar su solicitud m√°s r√°pidamente.
                    </p>
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 1.5rem;">
                        <button class="print-btn" onclick="downloadChecklistForType('adult-outside')" style="font-size: 1.05rem; padding: 1rem 2rem;">
                            üìÑ Adulto Fuera de Canad√°
                        </button>
                        <button class="print-btn" onclick="downloadChecklistForType('adult-inside')" style="font-size: 1.05rem; padding: 1rem 2rem;">
                            üìÑ Adulto Dentro de Canad√°
                        </button>
                        <button class="print-btn" onclick="downloadChecklistForType('child')" style="font-size: 1.05rem; padding: 1rem 2rem;">
                            üìÑ Menor de Edad
                        </button>
                    </div>
                    <p style="margin-top: 1.5rem; font-size: 0.9rem; color: #558B2F; font-style: italic;">
                        üí° Tip: Imprima el checklist y m√°rquelo a medida que re√∫ne cada documento
                    </p>
                </div>

                <div class="btn-group" style="justify-content: center;">
                    <button class="btn btn-primary" onclick="goToStep(1)" style="font-size: 1.15rem; padding: 1.2rem 3rem;">
                        Iniciar Solicitud ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 1: Application Type -->
        <div class="step-content" id="step1">
            <div class="card">
                <h2 class="card-title">üìã Seleccione el tipo de solicitud</h2>
                
                <div class="alert alert-info">
                    Por favor, seleccione su situaci√≥n para mostrarle los documentos espec√≠ficos que necesita.
                    <br><br>
                    <small style="opacity: 0.8;">üí° <strong>Consejo:</strong> Haga doble click en su opci√≥n para avanzar autom√°ticamente.</small>
                </div>

                <div class="selection-grid">
                    <div class="selection-card" data-type="adulto-fuera">
                        <h3>üë®‚Äçüíº Adulto fuera de Canad√°</h3>
                        <p>Para personas adultas que se encuentran actualmente fuera de Canad√°.</p>
                    </div>
                    <div class="selection-card" data-type="adulto-dentro">
                        <h3>üë®‚Äçüíº Adulto dentro de Canad√°</h3>
                        <p>Para personas adultas que se encuentran actualmente en Canad√°.</p>
                    </div>
                    <div class="selection-card" data-type="nino">
                        <h3>üë∂ Ni√±os/Menores</h3>
                        <p>Para solicitudes de visa de turismo para ni√±os menores de 18 a√±os.</p>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(0)">
                        ‚Üê Volver a Inicio
                    </button>
                    <button class="btn btn-primary" id="nextStep1" disabled>
                        Continuar ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 2: Required Documents -->
        <div class="step-content" id="step2">
            <div class="card">
                <h2 class="card-title">üìë Documentos Requeridos</h2>
                
                <!-- Botones al inicio -->
                <div class="btn-group" style="margin-top: 0; margin-bottom: 2rem;">
                    <button class="btn btn-secondary" onclick="goToStep(1)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="print-btn" onclick="printChecklist()">
                        üñ®Ô∏è Imprimir Checklist
                    </button>
                    <button class="btn btn-primary" onclick="goToStep(3)">
                        Continuar ‚Üí
                    </button>
                </div>
                
                <div class="alert alert-info">
                    <strong>üí° Tip:</strong> Puede imprimir la lista de documentos requeridos para tener una referencia f√≠sica mientras prepara su solicitud.
                </div>
                
                <div class="alert alert-warning">
                    <h3 style="margin-bottom: 1rem; font-size: 1.05rem;">‚ö†Ô∏è Informaci√≥n Importante sobre Documentos</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 0.75rem; padding-left: 1.5rem; position: relative;">
                            <span style="position: absolute; left: 0; color: #F59E0B;">‚Ä¢</span>
                            <strong>Idioma:</strong> Todos los documentos que no est√©n en franc√©s o ingl√©s deben estar traducidos y acompa√±ados del documento original.
                        </li>
                        <li style="padding-left: 1.5rem; position: relative;">
                            <span style="position: absolute; left: 0; color: #F59E0B;">‚Ä¢</span>
                            <strong>Formato y Tama√±o:</strong> Los documentos deben subirse en formato PDF con un peso m√°ximo de 3.8 MB por archivo. La fotograf√≠a puede subirse tambi√©n en formato JPEG.
                        </li>
                    </ul>
                </div>

                <div id="documentList"></div>

                <!-- Botones al final -->
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(1)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="print-btn" onclick="printChecklist()">
                        üñ®Ô∏è Imprimir Checklist
                    </button>
                    <button class="btn btn-primary" onclick="goToStep(3)">
                        Continuar ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Checklist Imprimible (hidden) -->
        <div id="printableChecklist" style="display: none;">
            <!-- Contenido generado din√°micamente -->
        </div>

        <!-- Step 3: Upload Documents -->
        <div class="step-content" id="step3">
            <div class="card">
                <h2 class="card-title">üì§ Subir Documentos</h2>
                
                <!-- Botones al inicio -->
                <div class="btn-group" style="margin-top: 0; margin-bottom: 2rem;">
                    <button class="btn btn-secondary" onclick="goToStep(2)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="btn btn-primary" onclick="goToStep(4)">
                        Continuar ‚Üí
                    </button>
                </div>
                
                <div class="alert alert-info">
                    <h3 style="margin-bottom: 1rem; font-size: 1.05rem;">üì§ Instrucciones para Subir Documentos</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 0.75rem; padding-left: 1.5rem; position: relative;">
                            <span style="position: absolute; left: 0; color: #1976D2;">‚Ä¢</span>
                            <strong>Formato PDF:</strong> Todos los documentos deben subirse en formato PDF con un tama√±o m√°ximo de 3.8 MB por archivo.
                        </li>
                        <li style="margin-bottom: 0.75rem; padding-left: 1.5rem; position: relative;">
                            <span style="position: absolute; left: 0; color: #1976D2;">‚Ä¢</span>
                            <strong>Fotograf√≠a:</strong> La fotograf√≠a es el √∫nico documento que puede subirse tambi√©n en formato JPG/JPEG.
                        </li>
                        <li style="padding-left: 1.5rem; position: relative;">
                            <span style="position: absolute; left: 0; color: #1976D2;">‚Ä¢</span>
                            <strong>Documentos no aplicables:</strong> Si alg√∫n documento no aplica a su situaci√≥n, puede marcarlo como "No Aplica" para continuar.
                        </li>
                    </ul>
                </div>

                <div class="upload-grid" id="uploadGrid"></div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(2)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="btn btn-primary" onclick="goToStep(4)">
                        Continuar ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 4: Personal Information -->
        <div class="step-content" id="step4">
            <div class="card">
                <h2 class="card-title">‚úèÔ∏è Informaci√≥n Personal</h2>
                
                <form id="personalInfoForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nombre(s) <span class="required">*</span></label>
                            <input type="text" name="firstName" required>
                        </div>
                        <div class="form-group">
                            <label>Apellido(s) <span class="required">*</span></label>
                            <input type="text" name="lastName" required>
                        </div>
                        <div class="form-group">
                            <label>Fecha de Nacimiento <span class="required">*</span></label>
                            <input type="date" name="birthDate" required>
                        </div>
                        <div class="form-group">
                            <label>Lugar de Nacimiento <span class="required">*</span></label>
                            <input type="text" name="birthPlace" required>
                        </div>
                        <div class="form-group">
                            <label>Pa√≠s de Ciudadan√≠a <span class="required">*</span></label>
                            <input type="text" name="citizenship" required>
                        </div>
                        <div class="form-group">
                            <label>N√∫mero de Pasaporte <span class="required">*</span></label>
                            <input type="text" name="passportNumber" required>
                        </div>
                        <div class="form-group">
                            <label>Correo Electr√≥nico <span class="required">*</span></label>
                            <input type="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label>Tel√©fono <span class="required">*</span></label>
                            <input type="tel" name="phone" required>
                        </div>
                        <div class="form-group full-width">
                            <label>Direcci√≥n Completa <span class="required">*</span></label>
                            <textarea name="address" required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Fecha de Viaje (Ida) <span class="required">*</span></label>
                            <input type="date" name="travelDateStart" required>
                        </div>
                        <div class="form-group">
                            <label>Fecha de Viaje (Regreso) <span class="required">*</span></label>
                            <input type="date" name="travelDateEnd" required>
                        </div>
                        <div class="form-group full-width">
                            <label>Prop√≥sito del Viaje <span class="required">*</span></label>
                            <textarea name="travelPurpose" required placeholder="Describa brevemente el prop√≥sito de su viaje a Canad√°..."></textarea>
                        </div>
                    </div>
                </form>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(3)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="btn btn-primary" id="nextStep4">
                        Continuar ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 5: Travel Purpose / Motivo del Viaje -->
        <div class="step-content" id="step5">
            <div class="card">
                <h2 class="card-title">‚úàÔ∏è Motivo del Viaje</h2>
                
                <div class="alert alert-info">
                    <h3>üìù Instrucciones Importantes</h3>
                    <p style="margin-bottom: 1rem;">
                        <strong>Por favor, sea lo m√°s detallado y claro posible al describir el motivo de su viaje.</strong>
                    </p>
                    <p>
                        Es fundamental que mencione:
                    </p>
                    <ul style="margin-top: 0.5rem;">
                        <li><strong>Prop√≥sito principal:</strong> ¬øPor qu√© desea viajar a Canad√°? (turismo, visitar familia, negocios, etc.)</li>
                        <li><strong>Lugares a visitar:</strong> Ciudades y sitios espec√≠ficos que planea conocer</li>
                        <li><strong>Duraci√≥n:</strong> Tiempo exacto que permanecer√° en Canad√°</li>
                        <li><strong>Arraigo:</strong> Razones por las cuales regresar√° a su pa√≠s de origen (trabajo, familia, propiedades, estudios, etc.)</li>
                        <li><strong>Itinerario:</strong> Si tiene un plan espec√≠fico de actividades</li>
                    </ul>
                    <p style="margin-top: 1rem;">
                        <strong>Recuerde:</strong> La honestidad y el detalle son fundamentales. Una carta bien elaborada aumenta las posibilidades de aprobaci√≥n.
                    </p>
                </div>

                <div class="alert alert-warning">
                    <strong>‚ö†Ô∏è Importante:</strong> Esta informaci√≥n es revisada cuidadosamente por los oficiales de IRCC. 
                    Aseg√∫rese de que coincida con la documentaci√≥n que ha presentado.
                </div>

                <form id="travelPurposeForm">
                    <div class="form-section">
                        <h3 class="form-section-title">üìã Carta de Motivaci√≥n</h3>
                        
                        <div class="form-group full-width">
                            <label for="travelPurpose">
                                Describa detalladamente el motivo de su viaje a Canad√° <span class="required">*</span>
                            </label>
                            <textarea 
                                id="travelPurpose" 
                                name="travelPurpose" 
                                required
                                style="min-height: 300px;"
                                placeholder="Ejemplo:

El prop√≥sito de mi viaje a Canad√° es visitar a mi hermana [Nombre] quien reside en Toronto desde hace 5 a√±os. Planeo quedarme durante 3 semanas (del [fecha] al [fecha]).

Durante mi estancia, tengo planeado:
- Visitar las Cataratas del Ni√°gara
- Conocer el centro de Toronto
- Pasar tiempo con mi familia

Tengo fuertes lazos con mi pa√≠s de origen que garantizan mi retorno:
- Soy propietario de [negocio/propiedad]
- Tengo un empleo estable como [cargo] en [empresa] desde hace [X] a√±os
- Mi familia (esposa e hijos) permanecer√°n en [pa√≠s]
- Mis estudios universitarios contin√∫an en [universidad]

Adjunto toda la documentaci√≥n que respalda esta informaci√≥n..."
                            ></textarea>
                            <small style="display: block; margin-top: 0.5rem; color: var(--warm-gray);">
                                M√≠nimo 200 palabras recomendadas. Sea espec√≠fico y honesto.
                            </small>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="estimatedBudget">
                                    Presupuesto estimado para el viaje (CAD) <span class="required">*</span>
                                </label>
                                <input 
                                    type="number" 
                                    id="estimatedBudget" 
                                    name="estimatedBudget" 
                                    required
                                    placeholder="Ej: 5000"
                                    min="0"
                                />
                            </div>

                            <div class="form-group">
                                <label for="accommodationType">
                                    Tipo de alojamiento <span class="required">*</span>
                                </label>
                                <select id="accommodationType" name="accommodationType" required>
                                    <option value="">Seleccione...</option>
                                    <option value="family">Con familia/amigos</option>
                                    <option value="hotel">Hotel</option>
                                    <option value="airbnb">Airbnb/Alquiler</option>
                                    <option value="other">Otro</option>
                                </select>
                            </div>

                            <div class="form-group full-width">
                                <label for="previousVisits">
                                    ¬øHa visitado Canad√° anteriormente?
                                </label>
                                <div class="radio-group">
                                    <label>
                                        <input type="radio" name="previousVisits" value="yes" onclick="document.getElementById('previousVisitsDetails').style.display='block'">
                                        S√≠
                                    </label>
                                    <label>
                                        <input type="radio" name="previousVisits" value="no" onclick="document.getElementById('previousVisitsDetails').style.display='none'" checked>
                                        No
                                    </label>
                                </div>
                            </div>

                            <div class="form-group full-width" id="previousVisitsDetails" style="display: none;">
                                <label for="previousVisitsInfo">
                                    Detalles de visitas anteriores
                                </label>
                                <textarea 
                                    id="previousVisitsInfo" 
                                    name="previousVisitsInfo"
                                    placeholder="Indique cu√°ndo visit√≥ Canad√°, por cu√°nto tiempo y con qu√© prop√≥sito..."
                                    style="min-height: 80px;"
                                ></textarea>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(4)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="btn btn-primary" id="nextStep5">
                        Continuar ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 6: Review and Submit -->
        <div class="step-content" id="step6">
            <div class="card">
                <h2 class="card-title">‚úÖ Revisi√≥n y Env√≠o</h2>
                
                <div class="alert alert-success">
                    Por favor, revise toda la informaci√≥n antes de enviar. Una vez enviada, se generar√° un PDF con todos sus documentos y se enviar√° a LMBI Immigration.
                </div>

                <div id="reviewContent"></div>

                <!-- Confirmaci√≥n de Datos del Aplicante -->
                <div class="alert alert-warning" style="margin-top: 2rem;">
                    <h3 style="margin-bottom: 1rem;">‚ö†Ô∏è Confirmaci√≥n de Datos</h3>
                    <p style="margin-bottom: 1rem;">
                        <strong>Importante:</strong> Por favor, confirme sus datos de contacto antes de enviar la solicitud. 
                        Estos datos ser√°n utilizados para todas las comunicaciones relacionadas con su visa.
                    </p>
                    
                    <form id="finalConfirmationForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="confirmName">
                                    Nombre Completo <span class="required">*</span>
                                </label>
                                <input 
                                    type="text" 
                                    id="confirmName" 
                                    name="confirmName" 
                                    required
                                    readonly
                                    style="background: #F5F5F5; cursor: not-allowed;"
                                />
                            </div>

                            <div class="form-group">
                                <label for="confirmEmail">
                                    Correo Electr√≥nico <span class="required">*</span>
                                </label>
                                <input 
                                    type="email" 
                                    id="confirmEmail" 
                                    name="confirmEmail" 
                                    required
                                    readonly
                                    style="background: #F5F5F5; cursor: not-allowed;"
                                />
                            </div>

                            <div class="form-group">
                                <label for="confirmPhone">
                                    Tel√©fono <span class="required">*</span>
                                </label>
                                <input 
                                    type="tel" 
                                    id="confirmPhone" 
                                    name="confirmPhone" 
                                    required
                                    readonly
                                    style="background: #F5F5F5; cursor: not-allowed;"
                                />
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem; padding: 1.5rem; background: white; border: 2px solid var(--terracota-primary); border-radius: 10px;">
                            <div class="checkbox-group" style="flex-direction: column; gap: 1rem;">
                                <label style="cursor: pointer; display: flex; align-items: flex-start; gap: 0.7rem;">
                                    <input 
                                        type="checkbox" 
                                        id="confirmDocuments" 
                                        required
                                        style="margin-top: 0.2rem; flex-shrink: 0;"
                                    >
                                    <span style="font-weight: 500; line-height: 1.6;">
                                        Confirmo que he adjuntado todos los documentos requeridos seg√∫n mi tipo de solicitud.
                                    </span>
                                </label>

                                <label style="cursor: pointer; display: flex; align-items: flex-start; gap: 0.7rem;">
                                    <input 
                                        type="checkbox" 
                                        id="confirmInfo" 
                                        required
                                        style="margin-top: 0.2rem; flex-shrink: 0;"
                                    >
                                    <span style="font-weight: 500; line-height: 1.6;">
                                        Confirmo que toda la informaci√≥n proporcionada es verdadera y completa.
                                    </span>
                                </label>

                                <label style="cursor: pointer; display: flex; align-items: flex-start; gap: 0.7rem;">
                                    <input 
                                        type="checkbox" 
                                        id="confirmReview" 
                                        required
                                        style="margin-top: 0.2rem; flex-shrink: 0;"
                                    >
                                    <span style="font-weight: 500; line-height: 1.6;">
                                        He revisado cuidadosamente toda mi solicitud y estoy listo para enviarla.
                                    </span>
                                </label>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="loading" id="loadingSubmit">
                    <div class="spinner"></div>
                    <p>Generando PDF y enviando solicitud...</p>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goToStep(5)">
                        ‚Üê Atr√°s
                    </button>
                    <button class="btn btn-primary" id="submitApplication">
                        üì® Enviar Solicitud
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let appState = {
            currentStep: 0,
            applicationType: '',
            uploadedFiles: {},
            personalInfo: {},
            travelPurpose: {},
            language: 'es'
        };

        // Translations
        const translations = {
            es: {
                // Header
                headerTitle: 'Solicitud de Visa de Turismo Canadiense',
                
                // Welcome
                welcomeTitle: 'Bienvenido a LMBI Immigration',
                welcomeIntro: 'Le damos la bienvenida a nuestro portal de solicitud de visa de turismo canadiense. Estamos aqu√≠ para guiarle en cada paso del proceso de manera clara y profesional.',
                importantTitle: 'Informaci√≥n Importante - IRCC',
                importantText: '<strong>Nota Importante:</strong> La decisi√≥n de aprobar o rechazar una solicitud de visa es exclusivamente responsabilidad de los Agentes de Inmigraci√≥n de <strong>IRCC</strong> (Immigration, Refugees and Citizenship Canada). LMBI Immigration proporciona asistencia profesional en la preparaci√≥n de documentos, pero no puede garantizar la aprobaci√≥n de la visa.',
                importantLink: 'En caso de duda o para informaci√≥n oficial, siempre debe referirse a la p√°gina oficial de IRCC:',
                processTitle: 'Proceso de Solicitud',
                processSubtitle: 'Haga clic en cada paso para navegar directamente a esa secci√≥n:',
                process1Title: 'Tipo de Solicitud',
                process1Desc: 'Seleccione su situaci√≥n actual',
                process2Title: 'Documentos Requeridos',
                process2Desc: 'Revise la lista completa de documentos',
                process3Title: 'Subir Documentos',
                process3Desc: 'Suba todos los archivos requeridos',
                process4Title: 'Informaci√≥n Personal',
                process4Desc: 'Complete el formulario detallado',
                process5Title: 'Revisi√≥n y Env√≠o',
                process5Desc: 'Revise y env√≠e su solicitud',
                considerationsTitle: 'Aspectos Importantes a Considerar',
                consideration1: '<strong>Documentos Completos:</strong> Recuerde que es importante tener todos los documentos completos en el momento de enviar, de lo contrario, el proceso de realizaci√≥n de la visa podr√≠a tomar m√°s tiempo.',
                consideration2: '<strong>Arraigo en su Pa√≠s:</strong> Es importante tener en cuenta que el Gobierno de Canad√° tiene muy en cuenta el arraigo que usted pueda tener en su pa√≠s (familiar, propiedades, trabajo, empresa, etc.).',
                consideration3: '<strong>Aspectos Financieros:</strong> Los aspectos financieros son muy tenidos en cuenta. Tenga en cuenta que las <strong>tarjetas de cr√©dito NO son consideradas como activos</strong> para el gobierno de Canad√°.',
                consideration4: '<strong>Honestidad:</strong> Es importante siempre decir la verdad en toda la aplicaci√≥n. La falsificaci√≥n de informaci√≥n puede resultar en la prohibici√≥n permanente de ingresar a Canad√°.',
                startButton: 'Iniciar Solicitud ‚Üí',
                
                // Steps
                step1Title: 'Seleccione el tipo de solicitud',
                step1Info: 'Por favor, seleccione su situaci√≥n para mostrarle los documentos espec√≠ficos que necesita.',
                step1Tip: 'üí° <strong>Consejo:</strong> Haga doble click en su opci√≥n para avanzar autom√°ticamente.',
                step1Option1Title: 'Adulto fuera de Canad√°',
                step1Option1Desc: 'Para personas adultas que se encuentran actualmente fuera de Canad√°.',
                step1Option2Title: 'Adulto dentro de Canad√°',
                step1Option2Desc: 'Para personas adultas que se encuentran actualmente en Canad√°.',
                step1Option3Title: 'Ni√±os/Menores',
                step1Option3Desc: 'Para solicitudes de visa de turismo para ni√±os menores de 18 a√±os.',
                
                step2Title: 'Documentos Requeridos',
                step2Warning: '<strong>Idioma:</strong> Todos los documentos que no est√©n en franc√©s o ingl√©s deben estar traducidos y acompa√±ados del documento original.<br><br><strong>Formato y Tama√±o:</strong> Los documentos deben subirse en formato PDF con un peso m√°ximo de 3.8 MB por archivo. La fotograf√≠a puede subirse tambi√©n en formato JPEG.',
                step2DocsTitle: 'Documentos requeridos para su solicitud:',
                
                step3Title: 'Subir Documentos',
                step3Info: 'Por favor, suba todos los documentos requeridos. Formato: PDF (m√°ximo 3.8MB por archivo). Las fotograf√≠as pueden subirse tambi√©n en formato JPEG.',
                uploadClick: 'Click para seleccionar archivo',
                uploadDrag: 'o arrastre aqu√≠',
                uploadSize: 'PDF, JPG, PNG (m√°x. 10MB)',
                notApplicable: 'Este documento no aplica a mi situaci√≥n',
                notApplicableShort: 'No Aplica',
                
                step4Title: 'Informaci√≥n Personal',
                firstName: 'Nombre(s)',
                lastName: 'Apellido(s)',
                birthDate: 'Fecha de Nacimiento',
                birthPlace: 'Lugar de Nacimiento',
                citizenship: 'Pa√≠s de Ciudadan√≠a',
                passportNumber: 'N√∫mero de Pasaporte',
                email: 'Correo Electr√≥nico',
                phone: 'Tel√©fono',
                address: 'Direcci√≥n Completa',
                travelDateStart: 'Fecha de Viaje (Ida)',
                travelDateEnd: 'Fecha de Viaje (Regreso)',
                travelPurpose: 'Prop√≥sito del Viaje',
                travelPurposePlaceholder: 'Describa brevemente el prop√≥sito de su viaje a Canad√°...',
                required: '*',
                
                step5Title: 'Revisi√≥n y Env√≠o',
                step5Success: 'Por favor, revise toda la informaci√≥n antes de enviar. Una vez enviada, se generar√° un PDF con todos sus documentos y se enviar√° a LMBI Immigration.',
                personalInfoTitle: 'Informaci√≥n Personal',
                docsUploadedTitle: 'Documentos Subidos',
                submitButton: 'Enviar Solicitud',
                
                // Navigation
                navStep1: 'Tipo de Solicitud',
                navStep2: 'Documentos Requeridos',
                navStep3: 'Subir Documentos',
                navStep4: 'Informaci√≥n Personal',
                navStep5: 'Revisi√≥n y Env√≠o',
                
                // Buttons
                backToHome: 'Volver a Inicio',
                back: 'Atr√°s',
                continue: 'Continuar',
                
                // Messages
                successMessage: '¬°Solicitud enviada exitosamente!\n\nSu solicitud ha sido enviada a LMBI Immigration. Recibir√° una confirmaci√≥n por correo electr√≥nico pronto.\n\nN√∫mero de referencia:',
                errorMessage: 'Error al enviar la solicitud. Por favor, intente nuevamente.',
                fileTooLarge: 'El archivo es demasiado grande. Tama√±o m√°ximo: 3.8MB',
                loadingMessage: 'Generando PDF y enviando solicitud...'
            },
            en: {
                // Header
                headerTitle: 'Canadian Tourist Visa Application',
                
                // Welcome
                welcomeTitle: 'Welcome to LMBI Immigration',
                welcomeIntro: 'Welcome to our Canadian tourist visa application portal. We are here to guide you through every step of the process in a clear and professional manner.',
                importantTitle: 'Important Information - IRCC',
                importantText: '<strong>Important Note:</strong> The decision to approve or reject a visa application is solely the responsibility of <strong>IRCC</strong> (Immigration, Refugees and Citizenship Canada) Immigration Officers. LMBI Immigration provides professional assistance in preparing documents but cannot guarantee visa approval.',
                importantLink: 'For any doubts or official information, always refer to the official IRCC website:',
                processTitle: 'Application Process',
                processSubtitle: 'Click on each step to navigate directly to that section:',
                process1Title: 'Application Type',
                process1Desc: 'Select your current situation',
                process2Title: 'Required Documents',
                process2Desc: 'Review the complete list of documents',
                process3Title: 'Upload Documents',
                process3Desc: 'Upload all required files',
                process4Title: 'Personal Information',
                process4Desc: 'Complete the detailed form',
                process5Title: 'Review and Submit',
                process5Desc: 'Review and submit your application',
                considerationsTitle: 'Important Considerations',
                consideration1: '<strong>Complete Documents:</strong> Remember that it is important to have all documents complete at the time of submission, otherwise the visa process may take longer.',
                consideration2: '<strong>Ties to Your Country:</strong> It is important to note that the Government of Canada highly values the ties you may have to your country (family, property, work, business, etc.).',
                consideration3: '<strong>Financial Aspects:</strong> Financial aspects are highly considered. Please note that <strong>credit cards are NOT considered assets</strong> by the Government of Canada.',
                consideration4: '<strong>Honesty:</strong> It is always important to tell the truth throughout the application. Falsifying information can result in a permanent ban from entering Canada.',
                startButton: 'Start Application ‚Üí',
                
                // Steps
                step1Title: 'Select application type',
                step1Info: 'Please select your situation to show you the specific documents you need.',
                step1Tip: 'üí° <strong>Tip:</strong> Double-click on your option to advance automatically.',
                step1Option1Title: 'Adult outside Canada',
                step1Option1Desc: 'For adults currently outside of Canada.',
                step1Option2Title: 'Adult inside Canada',
                step1Option2Desc: 'For adults currently in Canada.',
                step1Option3Title: 'Children/Minors',
                step1Option3Desc: 'For tourist visa applications for children under 18 years old.',
                
                step2Title: 'Required Documents',
                step2Warning: '<strong>Language:</strong> All documents not in French or English must be translated and accompanied by the original document.<br><br><strong>Format and Size:</strong> Documents must be uploaded in PDF format with a maximum size of 3.8 MB per file. Photographs can also be uploaded in JPEG format.',
                step2DocsTitle: 'Required documents for your application:',
                
                step3Title: 'Upload Documents',
                step3Info: 'Please upload all required documents. Format: PDF (maximum 3.8MB per file). Photographs can also be uploaded in JPEG format.',
                uploadClick: 'Click to select file',
                uploadDrag: 'or drag here',
                uploadSize: 'PDF, JPG, PNG (max. 10MB)',
                notApplicable: 'This document does not apply to my situation',
                notApplicableShort: 'Not Applicable',
                
                step4Title: 'Personal Information',
                firstName: 'First Name(s)',
                lastName: 'Last Name(s)',
                birthDate: 'Date of Birth',
                birthPlace: 'Place of Birth',
                citizenship: 'Country of Citizenship',
                passportNumber: 'Passport Number',
                email: 'Email Address',
                phone: 'Phone',
                address: 'Full Address',
                travelDateStart: 'Travel Date (Departure)',
                travelDateEnd: 'Travel Date (Return)',
                travelPurpose: 'Purpose of Travel',
                travelPurposePlaceholder: 'Briefly describe the purpose of your trip to Canada...',
                required: '*',
                
                step5Title: 'Review and Submit',
                step5Success: 'Please review all information before submitting. Once submitted, a PDF will be generated with all your documents and sent to LMBI Immigration.',
                personalInfoTitle: 'Personal Information',
                docsUploadedTitle: 'Uploaded Documents',
                submitButton: 'Submit Application',
                
                // Navigation
                navStep1: 'Application Type',
                navStep2: 'Required Documents',
                navStep3: 'Upload Documents',
                navStep4: 'Personal Information',
                navStep5: 'Review & Submit',
                
                // Buttons
                backToHome: 'Back to Home',
                back: 'Back',
                continue: 'Continue',
                
                // Messages
                successMessage: 'Application submitted successfully!\n\nYour application has been sent to LMBI Immigration. You will receive an email confirmation soon.\n\nReference number:',
                errorMessage: 'Error submitting application. Please try again.',
                fileTooLarge: 'File is too large. Maximum size: 3.8MB',
                loadingMessage: 'Generating PDF and submitting application...'
            },
            fr: {
                // Header
                headerTitle: 'Demande de Visa Touristique Canadien',
                
                // Welcome
                welcomeTitle: 'Bienvenue chez LMBI Immigration',
                welcomeIntro: 'Bienvenue sur notre portail de demande de visa touristique canadien. Nous sommes l√† pour vous guider √† chaque √©tape du processus de mani√®re claire et professionnelle.',
                importantTitle: 'Information Importante - IRCC',
                importantText: '<strong>Note Importante:</strong> La d√©cision d\'approuver ou de rejeter une demande de visa rel√®ve exclusivement de la responsabilit√© des agents d\'immigration d\'<strong>IRCC</strong> (Immigration, R√©fugi√©s et Citoyennet√© Canada). LMBI Immigration fournit une assistance professionnelle dans la pr√©paration des documents mais ne peut garantir l\'approbation du visa.',
                importantLink: 'En cas de doute ou pour des informations officielles, r√©f√©rez-vous toujours au site officiel d\'IRCC:',
                processTitle: 'Processus de Demande',
                processSubtitle: 'Cliquez sur chaque √©tape pour naviguer directement vers cette section:',
                process1Title: 'Type de Demande',
                process1Desc: 'S√©lectionnez votre situation actuelle',
                process2Title: 'Documents Requis',
                process2Desc: 'Consultez la liste compl√®te des documents',
                process3Title: 'T√©l√©charger Documents',
                process3Desc: 'T√©l√©chargez tous les fichiers requis',
                process4Title: 'Informations Personnelles',
                process4Desc: 'Remplissez le formulaire d√©taill√©',
                process5Title: 'R√©vision et Envoi',
                process5Desc: 'R√©visez et soumettez votre demande',
                considerationsTitle: 'Aspects Importants √† Consid√©rer',
                consideration1: '<strong>Documents Complets:</strong> N\'oubliez pas qu\'il est important d\'avoir tous les documents complets au moment de la soumission, sinon le processus de visa pourrait prendre plus de temps.',
                consideration2: '<strong>Liens avec Votre Pays:</strong> Il est important de noter que le gouvernement du Canada accorde une grande importance aux liens que vous pouvez avoir avec votre pays (famille, propri√©t√©, travail, entreprise, etc.).',
                consideration3: '<strong>Aspects Financiers:</strong> Les aspects financiers sont tr√®s pris en compte. Veuillez noter que les <strong>cartes de cr√©dit ne sont PAS consid√©r√©es comme des actifs</strong> par le gouvernement du Canada.',
                consideration4: '<strong>Honn√™tet√©:</strong> Il est toujours important de dire la v√©rit√© tout au long de la demande. La falsification d\'informations peut entra√Æner une interdiction permanente d\'entrer au Canada.',
                startButton: 'Commencer la Demande ‚Üí',
                
                // Steps
                step1Title: 'S√©lectionnez le type de demande',
                step1Info: 'Veuillez s√©lectionner votre situation pour vous montrer les documents sp√©cifiques dont vous avez besoin.',
                step1Tip: 'üí° <strong>Conseil:</strong> Double-cliquez sur votre option pour avancer automatiquement.',
                step1Option1Title: 'Adulte hors du Canada',
                step1Option1Desc: 'Pour les adultes actuellement hors du Canada.',
                step1Option2Title: 'Adulte au Canada',
                step1Option2Desc: 'Pour les adultes actuellement au Canada.',
                step1Option3Title: 'Enfants/Mineurs',
                step1Option3Desc: 'Pour les demandes de visa touristique pour les enfants de moins de 18 ans.',
                
                step2Title: 'Documents Requis',
                step2Warning: '<strong>Langue:</strong> Tous les documents qui ne sont pas en fran√ßais ou en anglais doivent √™tre traduits et accompagn√©s du document original.<br><br><strong>Format et Taille:</strong> Les documents doivent √™tre t√©l√©charg√©s au format PDF avec une taille maximale de 3.8 MB par fichier. Les photographies peuvent √©galement √™tre t√©l√©charg√©es au format JPEG.',
                step2DocsTitle: 'Documents requis pour votre demande:',
                
                step3Title: 'T√©l√©charger les Documents',
                step3Info: 'Veuillez t√©l√©charger tous les documents requis. Format: PDF (maximum 3.8MB par fichier). Les photographies peuvent √©galement √™tre t√©l√©charg√©es au format JPEG.',
                uploadClick: 'Cliquez pour s√©lectionner un fichier',
                uploadDrag: 'ou glissez ici',
                uploadSize: 'PDF, JPG, PNG (max. 10MB)',
                notApplicable: 'Ce document ne s\'applique pas √† ma situation',
                notApplicableShort: 'Non Applicable',
                
                step4Title: 'Informations Personnelles',
                firstName: 'Pr√©nom(s)',
                lastName: 'Nom(s)',
                birthDate: 'Date de Naissance',
                birthPlace: 'Lieu de Naissance',
                citizenship: 'Pays de Citoyennet√©',
                passportNumber: 'Num√©ro de Passeport',
                email: 'Adresse Email',
                phone: 'T√©l√©phone',
                address: 'Adresse Compl√®te',
                travelDateStart: 'Date de Voyage (D√©part)',
                travelDateEnd: 'Date de Voyage (Retour)',
                travelPurpose: 'Motif du Voyage',
                travelPurposePlaceholder: 'D√©crivez bri√®vement le but de votre voyage au Canada...',
                required: '*',
                
                step5Title: 'R√©vision et Envoi',
                step5Success: 'Veuillez v√©rifier toutes les informations avant de soumettre. Une fois soumis, un PDF sera g√©n√©r√© avec tous vos documents et envoy√© √† LMBI Immigration.',
                personalInfoTitle: 'Informations Personnelles',
                docsUploadedTitle: 'Documents T√©l√©charg√©s',
                submitButton: 'Soumettre la Demande',
                
                // Navigation
                navStep1: 'Type de Demande',
                navStep2: 'Documents Requis',
                navStep3: 'T√©l√©charger Documents',
                navStep4: 'Informations Personnelles',
                navStep5: 'R√©vision et Envoi',
                
                // Buttons
                backToHome: 'Retour √† l\'Accueil',
                back: 'Retour',
                continue: 'Continuer',
                
                // Messages
                successMessage: 'Demande soumise avec succ√®s!\n\nVotre demande a √©t√© envoy√©e √† LMBI Immigration. Vous recevrez bient√¥t une confirmation par email.\n\nNum√©ro de r√©f√©rence:',
                errorMessage: 'Erreur lors de la soumission de la demande. Veuillez r√©essayer.',
                fileTooLarge: 'Le fichier est trop volumineux. Taille maximale: 3.8MB',
                loadingMessage: 'G√©n√©ration du PDF et envoi de la demande...'
            }
        };

        // Get translation
        function t(key) {
            return translations[appState.language][key] || key;
        }

        // Document Requirements
        const documentRequirements = {
            'adulto-fuera': [
                { id: 'passport', title: '1. Pasaportes (actual y anteriores)', description: 'Debe digitalizar todas las p√°ginas de su pasaporte actual y de cualquier pasaporte anterior que haya tenido, asegur√°ndose de incluir toda la informaci√≥n personal y los sellos de inmigraci√≥n. Es fundamental que tambi√©n incluya las p√°ginas que contengan visas previas, si las posee.', required: true, badge: 'Obligatorio' },
                { id: 'id', title: '2. Documento de identidad', description: 'Escanear recto-verso el documento de identidad de su pa√≠s (ej: c√©dula de ciudadan√≠a).', required: true, badge: 'Obligatorio' },
                { id: 'photo', title: '3. Fotograf√≠a', description: 'Ver especificaciones de las fotograf√≠as. Este documento se puede enviar en PDF o JPG. Consulte las especificaciones en la p√°gina oficial de IRCC.', required: true, badge: 'Obligatorio' },
                { id: 'invitation', title: '4. Carta de invitaci√≥n (affidavit) + pruebas', description: 'La carta de invitaci√≥n debe especificar de manera expl√≠cita que el invitado se alojar√° en su residencia, recibiendo hospedaje y alimentaci√≥n a lo largo de su estancia en Canad√°. La persona que invita debe adjuntar: pasaporte escaneado, prueba de status migratorio (si tiene status temporal), carta de empleo y dos √∫ltimos comprobantes de pago o declaraci√≥n de impuestos, y documento que pruebe la relaci√≥n (ej: certificado de nacimiento). Si no est√° en franc√©s o ingl√©s, debe traducirse.', required: true, badge: 'Obligatorio' },
                { id: 'employment', title: '5. Prueba de ocupaci√≥n + dos √∫ltimos comprobantes de pago', description: 'Si es empleado: Carta laboral indicando fecha de inicio, tiempo en la empresa, cargo y salario mensual (si es posible). Si es trabajador independiente: Carta de contador indicando actividad e ingresos mensuales (adjuntar tarjeta profesional del contador). Si es pensionado: Comprobante de pensi√≥n. La carta laboral debe traducirse si no est√° en franc√©s o ingl√©s.', required: true, badge: 'Obligatorio' },
                { id: 'bank', title: '6. Extractos bancarios', description: 'Adjuntar los 4 √∫ltimos extractos bancarios. En caso de dep√≥sitos de montos altos, adjuntar recibos que comprueben el origen de los fondos. Este documento es fundamental para que el oficial de inmigraci√≥n compruebe que cuenta con recursos para el viaje. Incluir certificado bancario con el saldo de la cuenta (generalmente se puede descargar directamente en ingl√©s del banco).', required: true, badge: 'Obligatorio' },
                { id: 'property', title: '7. Documentos de propiedad', description: 'Adjuntar documentos de propiedad de casas, terrenos, lotes, bien ra√≠z, etc. (ej: escrituras, compraventas, futuras herencias). Deben estar traducidos. Si el documento es muy largo, traducir solo las p√°ginas con informaci√≥n importante del inmueble.', required: true, badge: 'Obligatorio' },
                { id: 'vacation', title: '8. Carta de vacaciones o de licencia laboral', description: 'La carta debe ser expedida por la empresa donde trabaja, especificando el tiempo de vacaciones o licencia para el viaje a Canad√°. Es importante que las fechas de vacaciones est√©n acorde con la duraci√≥n del viaje.', required: true, badge: 'Obligatorio' },
                { id: 'tickets', title: '9. Reservaci√≥n de los tiquetes de viaje (ida y regreso)', description: 'La reservaci√≥n debe tener los nombres de las personas que van a viajar y las fechas deben coincidir con el formulario de inmigraci√≥n y la carta de vacaciones. Considere que el tiempo de procesamiento es discrecional. Si compra los tiquetes, h√°galo con posibilidad de cambio de fechas.', required: true, badge: 'Obligatorio' },
                { id: 'cv', title: '10. CV actualizada en FR o ENG', description: 'Incluir la hoja de vida actualizada. Este documento debe estar en franc√©s o ingl√©s.', required: false, badge: 'Opcional' },
                { id: 'diploma', title: '11. Diploma de estudios', description: 'Incluir los diplomas de estudio principales (no es necesario enviar diplomas de cursos de perfeccionamiento). Debe ir traducido. SOLO SI ENV√çA EL CV.', required: false, badge: 'Opcional' },
                { id: 'other-property', title: '12. Otras propiedades', description: 'Veh√≠culos, compraventas, compromisos de compra, futuras herencias, etc. Estos documentos deben ir traducidos.', required: false, badge: 'Opcional' },
                { id: 'company-docs', title: '13. Documentos de la empresa', description: 'Si es propietario o socio de una empresa: documentos de registro, documentos de constituci√≥n, y documento notariado dejando representante durante su estad√≠a en Canad√°. Todos deben estar traducidos.', required: false, badge: 'Si Aplica' },
                { id: 'marriage', title: '14. Certificado de matrimonio o uni√≥n libre', description: 'Adjuntar seg√∫n su caso. Este documento debe traducirse.', required: false, badge: 'Si Aplica' },
                { id: 'birth-children', title: '15. Certificados de nacimiento de los hijos', description: 'Adjuntar los certificados de nacimiento de los hijos. Si no viaja con ellos, es importante para comprobar arraigo con el pa√≠s de origen. Debe traducirse.', required: false, badge: 'Si Aplica' }
            ],
            'adulto-dentro': [
                { id: 'passport', title: '1. Pasaportes (actual y anteriores)', description: 'Debe digitalizar todas las p√°ginas de su pasaporte actual y de cualquier pasaporte anterior que haya tenido, asegur√°ndose de incluir toda la informaci√≥n personal y los sellos de inmigraci√≥n. Es fundamental que tambi√©n incluya las p√°ginas que contengan visas previas, si las posee.', required: true, badge: 'Obligatorio' },
                { id: 'id', title: '2. Documento de identidad', description: 'Escanear recto-verso el documento de identidad de su pa√≠s (ej: c√©dula de ciudadan√≠a).', required: true, badge: 'Obligatorio' },
                { id: 'photo', title: '3. Fotograf√≠a', description: 'Ver especificaciones de las fotograf√≠as seg√∫n est√°ndares canadienses. Este documento se puede enviar en PDF o JPG.', required: true, badge: 'Obligatorio' },
                { id: 'status', title: '4. Prueba de status migratorio', description: 'Enviar una copia escaneada (por ambos lados) del permiso de trabajo o permiso de estudio vigente.', required: true, badge: 'Obligatorio' },
                { id: 'employment', title: '5. Prueba de ocupaci√≥n + desprendibles de pago', description: 'Carta laboral donde se indique la fecha de inicio del empleo y el tiempo que lleva en la empresa, el cargo. Incluir los dos √∫ltimos comprobantes de pago de salario.', required: true, badge: 'Obligatorio' },
                { id: 'bank', title: '6. Extractos bancarios', description: 'Adjuntar los 4 √∫ltimos extractos bancarios.', required: true, badge: 'Obligatorio' },
                { id: 'marriage', title: '7. Certificado de matrimonio o uni√≥n libre', description: 'Adjuntar el certificado seg√∫n su caso. Este documento debe traducirse.', required: false, badge: 'Si Aplica' },
                { id: 'birth-children', title: '8. Certificados de nacimiento de los hijos', description: 'Adjuntar los certificados de nacimiento de los hijos. Si no viaja con ellos, es importante para comprobar arraigo con el pa√≠s de origen. Debe traducirse.', required: false, badge: 'Si Aplica' }
            ],
            'nino': [
                { id: 'passport', title: '1. Pasaportes (actual y anteriores)', description: 'Scanner de todas las p√°ginas del pasaporte donde se encuentren los datos personales y los sellos de inmigraci√≥n. Es importante incluir las visas que haya tenido.', required: true, badge: 'Obligatorio' },
                { id: 'id', title: '2. Tarjeta de identidad', description: 'Escanear la tarjeta de identidad por ambos lados (si aplica).', required: false, badge: 'Si Aplica' },
                { id: 'photo', title: '3. Fotograf√≠a', description: 'Ver especificaciones de las fotograf√≠as seg√∫n est√°ndares canadienses.', required: true, badge: 'Obligatorio' },
                { id: 'travel-history', title: '4. Viajes realizados', description: 'Historial de viajes: Pa√≠s de viaje, fecha de ida y regreso, motivo de viaje. Es importante que los viajes concuerden con los sellos del pasaporte. Puede ir en un documento aparte.', required: true, badge: 'Obligatorio' },
                { id: 'invitation', title: '5. Carta de invitaci√≥n (host) + pruebas', description: 'Carta especificando hospedaje y alimentaci√≥n durante la estad√≠a en Canad√°. Debe ir sellada por notario o comisario. Incluir itinerarios de viaje, carta laboral del anfitri√≥n, dos √∫ltimos desprendibles de pago o declaraci√≥n de impuestos, y prueba de relaci√≥n (ej: certificado de nacimiento). Si no est√° en franc√©s o ingl√©s, traducir.', required: true, badge: 'Obligatorio' },
                { id: 'school', title: '6. Certificado de estudios', description: 'Certificado emitido por la escuela mencionando que el estudiante est√° activo. Debe ir traducida. Si realiza actividad extra, art√≠stica o deportiva, anexar carta (traducida).', required: true, badge: 'Obligatorio' },
                { id: 'birth', title: '7. Registro civil', description: 'Adjuntar el registro civil de nacimiento. Este documento debe estar traducido.', required: true, badge: 'Obligatorio' },
                { id: 'tickets', title: '8. Reservaci√≥n o compra de tiquetes (ida y regreso)', description: 'Este documento es necesario para enviar la aplicaci√≥n. El Gobierno de Canad√° procesa las visas discrecionalmente, as√≠ que es mejor comprar los tiquetes con posibilidad de cambio de fechas.', required: true, badge: 'Obligatorio' },
                { id: 'parental', title: '9. Autorizaci√≥n parental para salida al extranjero', description: 'Si el ni√±o viaja con uno solo de los padres: autorizaci√≥n de salida del padre que no viaja, con identificaci√≥n. Preguntar en la oficina de inmigraci√≥n de su pa√≠s cu√°l es el documento correcto. Si los padres est√°n separados, adjuntar documentos de custodia. Deben estar traducidos.', required: true, badge: 'Obligatorio' },
                { id: 'motivation', title: '10. Carta de motivaci√≥n', description: 'Expresar el inter√©s del viaje a Canad√°, lugares que quisiera visitar. Incluir las fechas pensadas para el viaje. Diligenciar en el documento de informaci√≥n adicional.', required: true, badge: 'Obligatorio' }
            ]
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeLanguageSelector();
            initializeSelectionCards();
            document.getElementById('nextStep4').addEventListener('click', handleStep4Next);
            document.getElementById('nextStep5').addEventListener('click', handleStep5Next);
            document.getElementById('submitApplication').addEventListener('click', submitApplication);
            
            // Initialize progress bar
            updateProgressBar(0);
        });

        // Language Selector
        function initializeLanguageSelector() {
            const langBtn = document.getElementById('langBtn');
            const langDropdown = document.getElementById('langDropdown');
            const langOptions = document.querySelectorAll('.lang-option');

            langBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                langDropdown.classList.toggle('show');
            });

            document.addEventListener('click', () => {
                langDropdown.classList.remove('show');
            });

            langOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const lang = option.dataset.lang;
                    
                    langOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    
                    // Change language
                    changeLanguage(lang);
                    
                    langDropdown.classList.remove('show');
                });
            });
        }

        // Change Language
        function changeLanguage(lang) {
            appState.language = lang;
            
            const langText = {
                'es': 'üá™üá∏ Espa√±ol',
                'en': 'üá¨üáß English',
                'fr': 'üá´üá∑ Fran√ßais'
            };
            document.querySelector('.lang-current').textContent = langText[lang];
            
            // Update all UI text
            updateAllText();
        }

        // Update All Text
        function updateAllText() {
            // Header
            document.querySelector('.logo p').textContent = t('headerTitle');
            
            // Update current step content
            if (appState.currentStep === 0) {
                updateWelcomePage();
            } else if (appState.currentStep === 1) {
                updateStep1();
            } else if (appState.currentStep === 2) {
                updateStep2();
            } else if (appState.currentStep === 3) {
                updateStep3();
            } else if (appState.currentStep === 4) {
                updateStep4();
            } else if (appState.currentStep === 5) {
                updateStep5();
            }
        }

        // Update Welcome Page
        function updateWelcomePage() {
            document.querySelector('#stepWelcome .card-title').innerHTML = 'üè† ' + t('welcomeTitle');
            document.querySelector('#stepWelcome .welcome-intro').textContent = t('welcomeIntro');
            document.querySelector('#stepWelcome .alert-warning h3').textContent = '‚ö†Ô∏è ' + t('importantTitle');
            
            const alertWarning = document.querySelector('#stepWelcome .alert-warning');
            const paras = alertWarning.querySelectorAll('p');
            paras[0].innerHTML = t('importantText');
            paras[1].innerHTML = t('importantLink') + ' <a href="https://www.canada.ca/en/immigration-refugees-citizenship.html" target="_blank">www.canada.ca</a>';
            
            const h3s = document.querySelectorAll('#stepWelcome h3');
            h3s[1].textContent = 'üìã ' + t('processTitle');
            h3s[1].nextElementSibling.textContent = t('processSubtitle');
            
            const processCards = document.querySelectorAll('.process-card');
            processCards[0].querySelector('h4').textContent = t('process1Title');
            processCards[0].querySelector('p').textContent = t('process1Desc');
            processCards[1].querySelector('h4').textContent = t('process2Title');
            processCards[1].querySelector('p').textContent = t('process2Desc');
            processCards[2].querySelector('h4').textContent = t('process3Title');
            processCards[2].querySelector('p').textContent = t('process3Desc');
            processCards[3].querySelector('h4').textContent = t('process4Title');
            processCards[3].querySelector('p').textContent = t('process4Desc');
            processCards[4].querySelector('h4').textContent = t('process5Title');
            processCards[4].querySelector('p').textContent = t('process5Desc');
            
            document.querySelector('#stepWelcome .alert-info h3').textContent = 'üí° ' + t('considerationsTitle');
            const considerations = document.querySelectorAll('#stepWelcome .alert-info li');
            considerations[0].innerHTML = t('consideration1');
            considerations[1].innerHTML = t('consideration2');
            considerations[2].innerHTML = t('consideration3');
            considerations[3].innerHTML = t('consideration4');
            
            document.querySelector('#stepWelcome .btn-primary').textContent = t('startButton');
        }

        // Update Step 1
        function updateStep1() {
            document.querySelector('#step1 .card-title').textContent = 'üìã ' + t('step1Title');
            
            const alertInfo = document.querySelector('#step1 .alert-info');
            alertInfo.innerHTML = t('step1Info') + '<br><br><small style="opacity: 0.8;">' + t('step1Tip') + '</small>';
            
            const selectionCards = document.querySelectorAll('#step1 .selection-card');
            selectionCards[0].querySelector('h3').textContent = 'üë®‚Äçüíº ' + t('step1Option1Title');
            selectionCards[0].querySelector('p').textContent = t('step1Option1Desc');
            selectionCards[1].querySelector('h3').textContent = 'üë®‚Äçüíº ' + t('step1Option2Title');
            selectionCards[1].querySelector('p').textContent = t('step1Option2Desc');
            selectionCards[2].querySelector('h3').textContent = 'üë∂ ' + t('step1Option3Title');
            selectionCards[2].querySelector('p').textContent = t('step1Option3Desc');
            
            const btns = document.querySelectorAll('#step1 .btn');
            btns[0].textContent = '‚Üê ' + t('backToHome');
            btns[1].textContent = t('continue') + ' ‚Üí';
        }

        // Update Step 2
        function updateStep2() {
            document.querySelector('#step2 .card-title').textContent = 'üìë ' + t('step2Title');
            document.querySelector('#step2 .alert-warning').innerHTML = '<h3 style="margin-bottom: 1rem; font-size: 1.05rem;">‚ö†Ô∏è Informaci√≥n Importante sobre Documentos</h3><p>' + t('step2Warning') + '</p>';
            
            if (document.querySelector('#step2 .doc-list h3')) {
                document.querySelector('#step2 .doc-list h3').textContent = t('step2DocsTitle');
            }
            
            const btns = document.querySelectorAll('#step2 .btn');
            btns[0].textContent = '‚Üê ' + t('back');
            btns[1].textContent = t('continue') + ' ‚Üí';
        }

        // Update Step 3
        function updateStep3() {
            document.querySelector('#step3 .card-title').textContent = 'üì§ ' + t('step3Title');
            document.querySelector('#step3 .alert-info').textContent = t('step3Info');
            
            const btns = document.querySelectorAll('#step3 .btn');
            btns[0].textContent = '‚Üê ' + t('back');
            btns[1].textContent = t('continue') + ' ‚Üí';
        }

        // Update Step 4
        function updateStep4() {
            document.querySelector('#step4 .card-title').textContent = '‚úèÔ∏è ' + t('step4Title');
            
            const labels = document.querySelectorAll('#step4 label');
            labels[0].innerHTML = t('firstName') + ' <span class="required">*</span>';
            labels[1].innerHTML = t('lastName') + ' <span class="required">*</span>';
            labels[2].innerHTML = t('birthDate') + ' <span class="required">*</span>';
            labels[3].innerHTML = t('birthPlace') + ' <span class="required">*</span>';
            labels[4].innerHTML = t('citizenship') + ' <span class="required">*</span>';
            labels[5].innerHTML = t('passportNumber') + ' <span class="required">*</span>';
            labels[6].innerHTML = t('email') + ' <span class="required">*</span>';
            labels[7].innerHTML = t('phone') + ' <span class="required">*</span>';
            labels[8].innerHTML = t('address') + ' <span class="required">*</span>';
            labels[9].innerHTML = t('travelDateStart') + ' <span class="required">*</span>';
            labels[10].innerHTML = t('travelDateEnd') + ' <span class="required">*</span>';
            labels[11].innerHTML = t('travelPurpose') + ' <span class="required">*</span>';
            
            document.querySelector('textarea[name="travelPurpose"]').placeholder = t('travelPurposePlaceholder');
            
            const btns = document.querySelectorAll('#step4 .btn');
            btns[0].textContent = '‚Üê ' + t('back');
            btns[1].textContent = t('continue') + ' ‚Üí';
        }

        // Update Step 5
        function updateStep5() {
            document.querySelector('#step5 .card-title').textContent = '‚úÖ ' + t('step5Title');
            document.querySelector('#step5 .alert-success').textContent = t('step5Success');
            
            document.querySelector('#step5 .loading p').textContent = t('loadingMessage');
            const btns = document.querySelectorAll('#step5 .btn');
            btns[0].textContent = '‚Üê ' + t('back');
            btns[1].textContent = 'üì® ' + t('submitButton');
        }


        // Selection Cards
        function initializeSelectionCards() {
            const cards = document.querySelectorAll('.selection-card');
            const nextBtn = document.getElementById('nextStep1');

            cards.forEach(card => {
                // Single click - seleccionar
                card.addEventListener('click', function() {
                    cards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    appState.applicationType = this.dataset.type;
                    nextBtn.disabled = false;
                });

                // Double click - seleccionar y avanzar autom√°ticamente
                card.addEventListener('dblclick', function() {
                    cards.forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    appState.applicationType = this.dataset.type;
                    nextBtn.disabled = false;
                    
                    // Avanzar autom√°ticamente despu√©s de un breve delay
                    setTimeout(() => {
                        showDocumentList();
                        goToStep(2);
                    }, 300);
                });
            });

            nextBtn.addEventListener('click', () => {
                showDocumentList();
                goToStep(2);
            });
        }

        // Go to Step
        function goToStep(stepNumber) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            const stepId = stepNumber === 0 ? 'stepWelcome' : `step${stepNumber}`;
            const stepElement = document.getElementById(stepId);
            if (stepElement) {
                stepElement.classList.add('active');
            }
            
            // Update state
            appState.currentStep = stepNumber;
            
            // Update progress bar
            updateProgressBar(stepNumber);
            
            // Update quick navigation
            updateQuickNav(stepNumber);
            
            // Show/hide quick nav and applicant info
            const quickNav = document.getElementById('quickNav');
            const applicantInfo = document.getElementById('applicantInfo');
            
            if (stepNumber === 0) {
                quickNav.classList.remove('show');
            } else {
                quickNav.classList.add('show');
                // Show applicant info if we have basic data
                if (appState.personalInfo.firstName && appState.personalInfo.email) {
                    applicantInfo.classList.add('show');
                    updateHeaderInfo();
                }
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update Progress Bar
        function updateProgressBar(step) {
            const totalSteps = 7; // 0-6 (7 steps total including welcome)
            const percentage = (step / (totalSteps - 1)) * 100;
            
            const progressBar = document.getElementById('globalProgressBar');
            const progressText = document.getElementById('progressText');
            
            progressBar.style.width = percentage + '%';
            
            const stepNames = {
                0: 'Bienvenida',
                1: 'Tipo de Solicitud',
                2: 'Documentos Requeridos',
                3: 'Subir Documentos',
                4: 'Informaci√≥n Personal',
                5: 'Motivo del Viaje',
                6: 'Revisi√≥n y Env√≠o'
            };
            
            progressText.textContent = `Paso ${step} de ${totalSteps - 1}: ${stepNames[step]} - ${Math.round(percentage)}% completado`;
        }

        // Update Quick Navigation
        function updateQuickNav(currentStep) {
            const navBtns = document.querySelectorAll('.quick-nav-btn');
            navBtns.forEach((btn, index) => {
                const btnStep = index + 1;
                btn.classList.remove('active');
                if (btnStep === currentStep) {
                    btn.classList.add('active');
                }
            });
        }

        // Update Header Info
        function updateHeaderInfo() {
            const headerName = document.getElementById('headerName');
            const headerEmail = document.getElementById('headerEmail');
            const headerPhone = document.getElementById('headerPhone');
            
            if (appState.personalInfo.firstName && appState.personalInfo.lastName) {
                headerName.textContent = `${appState.personalInfo.firstName} ${appState.personalInfo.lastName}`;
            }
            if (appState.personalInfo.email) {
                headerEmail.textContent = appState.personalInfo.email;
            }
            if (appState.personalInfo.phone) {
                headerPhone.textContent = appState.personalInfo.phone;
            }
        }

        // Show Document List
        function showDocumentList() {
            const listContainer = document.getElementById('documentList');
            const docs = documentRequirements[appState.applicationType];
            
            // Separar documentos por categor√≠a
            const obligatorios = docs.filter(doc => doc.badge === 'Obligatorio');
            const opcionales = docs.filter(doc => doc.badge === 'Opcional');
            const siAplica = docs.filter(doc => doc.badge === 'Si Aplica');
            
            let html = '<div class="doc-list">';
            
            // Documentos Obligatorios
            html += '<h3 style="color: var(--terracota-dark); margin-bottom: 1rem;">üìã Documentos Obligatorios</h3>';
            obligatorios.forEach((doc) => {
                html += `
                    <div class="doc-item">
                        <div class="doc-content" style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                                <h4 style="margin: 0;">${doc.title}</h4>
                                <span style="background: linear-gradient(135deg, var(--terracota-primary), var(--terracota-light)); color: white; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">${doc.badge}</span>
                            </div>
                            <p style="margin: 0;">${doc.description}</p>
                        </div>
                    </div>
                `;
            });
            
            // Documentos Opcionales
            if (opcionales.length > 0) {
                html += '<h3 style="color: var(--terracota-dark); margin: 2rem 0 1rem;">üìé Documentos Opcionales</h3>';
                opcionales.forEach((doc) => {
                    html += `
                        <div class="doc-item" style="border-left-color: #94A3B8;">
                            <div class="doc-content" style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                                    <h4 style="margin: 0;">${doc.title}</h4>
                                    <span style="background: #94A3B8; color: white; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">${doc.badge}</span>
                                </div>
                                <p style="margin: 0;">${doc.description}</p>
                            </div>
                        </div>
                    `;
                });
            }
            
            // Documentos Si Aplica
            if (siAplica.length > 0) {
                html += '<h3 style="color: var(--terracota-dark); margin: 2rem 0 1rem;">‚ö° Documentos Condicionales (Si Aplica)</h3>';
                siAplica.forEach((doc) => {
                    html += `
                        <div class="doc-item" style="border-left-color: #F59E0B;">
                            <div class="doc-content" style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
                                    <h4 style="margin: 0;">${doc.title}</h4>
                                    <span style="background: #F59E0B; color: white; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">${doc.badge}</span>
                                </div>
                                <p style="margin: 0;">${doc.description}</p>
                            </div>
                        </div>
                    `;
                });
            }
            
            html += '</div>';
            listContainer.innerHTML = html;
            
            // Also create upload sections
            createUploadSections();
        }

        // Create Upload Sections
        function createUploadSections() {
            const uploadGrid = document.getElementById('uploadGrid');
            const docs = documentRequirements[appState.applicationType];
            
            let html = '';
            docs.forEach(doc => {
                const isPhoto = doc.id === 'photo';
                const acceptTypes = isPhoto ? '.pdf,.jpg,.jpeg' : '.pdf';
                const badgeColor = doc.badge === 'Obligatorio' ? 'var(--terracota-primary)' : 
                                   doc.badge === 'Opcional' ? '#94A3B8' : '#F59E0B';
                
                html += `
                    <div class="upload-section" data-doc-id="${doc.id}">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                            <h4 style="margin: 0;">${doc.title} <span class="required">*</span></h4>
                            <span style="background: ${badgeColor}; color: white; padding: 0.2rem 0.6rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">
                                ${doc.badge}
                            </span>
                        </div>
                        <p style="font-size: 0.85rem; color: var(--warm-gray); margin-bottom: 1rem; line-height: 1.5;">
                            ${doc.description}
                        </p>
                        
                        <div class="upload-area" data-doc-id="${doc.id}">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">
                                <p><strong>Click para seleccionar archivo</strong></p>
                                <p>o arrastre aqu√≠</p>
                                <p style="margin-top: 0.5rem; font-size: 0.75rem; opacity: 0.7;">
                                    ${isPhoto ? 'PDF o JPG/JPEG' : 'PDF'} (m√°x. 3.8MB)
                                </p>
                            </div>
                            <div class="file-name"></div>
                            <input type="file" accept="${acceptTypes}" style="display: none;" data-doc-id="${doc.id}">
                        </div>
                        
                        <div style="margin-top: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="na-${doc.id}" class="na-checkbox" data-doc-id="${doc.id}" 
                                   style="width: 18px; height: 18px; cursor: pointer;">
                            <label for="na-${doc.id}" style="cursor: pointer; font-size: 0.9rem; color: var(--warm-gray); user-select: none;">
                                Este documento no aplica a mi situaci√≥n
                            </label>
                        </div>
                    </div>
                `;
            });
            
            uploadGrid.innerHTML = html;
            
            // Add event listeners to upload areas
            const uploadAreas = document.querySelectorAll('.upload-area');
            uploadAreas.forEach(area => {
                const input = area.querySelector('input[type="file"]');
                area.addEventListener('click', () => input.click());
                input.addEventListener('change', function() {
                    handleFileUpload(this, area);
                });
            });
            
            // Add event listeners to "No Aplica" checkboxes
            const naCheckboxes = document.querySelectorAll('.na-checkbox');
            naCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    handleNotApplicable(this);
                });
            });
        }

        // Handle File Upload
        function handleFileUpload(input, area) {
            const file = input.files[0];
            if (!file) return;
            
            // Check file size (3.8MB)
            if (file.size > 3.8 * 1024 * 1024) {
                alert(t('fileTooLarge'));
                return;
            }
            
            const docId = input.dataset.docId;
            appState.uploadedFiles[docId] = file;
            
            area.classList.add('has-file');
            area.querySelector('.upload-icon').textContent = '‚úÖ';
            area.querySelector('.file-name').textContent = file.name;
            
            // Uncheck "No Aplica" if file is uploaded
            const checkbox = document.getElementById(`na-${docId}`);
            if (checkbox) {
                checkbox.checked = false;
            }
        }

        // Handle Not Applicable
        function handleNotApplicable(checkbox) {
            const docId = checkbox.dataset.docId;
            const section = checkbox.closest('.upload-section');
            const uploadArea = section.querySelector('.upload-area');
            
            if (checkbox.checked) {
                // Mark as not applicable
                appState.uploadedFiles[docId] = 'N/A';
                uploadArea.classList.add('has-file');
                uploadArea.style.opacity = '0.5';
                uploadArea.style.pointerEvents = 'none';
                uploadArea.querySelector('.upload-icon').textContent = 'üö´';
                uploadArea.querySelector('.file-name').innerHTML = '<span style="color: #94A3B8; font-weight: 600;">No Aplica</span>';
                
                // Clear file input
                const fileInput = uploadArea.querySelector('input[type="file"]');
                fileInput.value = '';
            } else {
                // Remove not applicable status
                delete appState.uploadedFiles[docId];
                uploadArea.classList.remove('has-file');
                uploadArea.style.opacity = '1';
                uploadArea.style.pointerEvents = 'auto';
                uploadArea.querySelector('.upload-icon').textContent = 'üìÅ';
                uploadArea.querySelector('.file-name').textContent = '';
            }
        }

        // Handle Step 4 Next
        function handleStep4Next() {
            const form = document.getElementById('personalInfoForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const formData = new FormData(form);
            appState.personalInfo = {};
            for (let [key, value] of formData.entries()) {
                appState.personalInfo[key] = value;
            }
            
            // Update header with applicant info
            updateHeaderInfo();
            document.getElementById('applicantInfo').classList.add('show');
            
            goToStep(5);
        }

        // Handle Step 5 Next
        function handleStep5Next() {
            const form = document.getElementById('travelPurposeForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const formData = new FormData(form);
            appState.travelPurpose = {};
            for (let [key, value] of formData.entries()) {
                appState.travelPurpose[key] = value;
            }
            
            showReview();
            goToStep(6);
        }

        // Show Review
        function showReview() {
            const reviewContainer = document.getElementById('reviewContent');
            
            let html = `
                <div class="alert alert-info" style="background: linear-gradient(135deg, var(--terracota-primary), var(--terracota-light)); border: 3px solid var(--terracota-dark); box-shadow: 0 6px 20px rgba(200, 90, 79, 0.3); margin-bottom: 2rem;">
                    <h3 style="color: white; margin-bottom: 1.2rem; font-size: 1.3rem; font-weight: 700;">üìã SOLICITUD DE:</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem; font-size: 1rem;">
                        <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <strong style="color: var(--terracota-dark); display: block; margin-bottom: 0.5rem;">üë§ Nombre Completo</strong>
                            <span style="font-size: 1.2rem; font-weight: 700; color: var(--dark-text);">${appState.personalInfo.firstName || ''} ${appState.personalInfo.lastName || ''}</span>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <strong style="color: var(--terracota-dark); display: block; margin-bottom: 0.5rem;">üìß Correo Electr√≥nico</strong>
                            <span style="font-size: 1.1rem; font-weight: 700; color: var(--dark-text); word-break: break-word;">${appState.personalInfo.email || ''}</span>
                        </div>
                        <div style="background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <strong style="color: var(--terracota-dark); display: block; margin-bottom: 0.5rem;">üì± Tel√©fono</strong>
                            <span style="font-size: 1.2rem; font-weight: 700; color: var(--dark-text);">${appState.personalInfo.phone || ''}</span>
                        </div>
                    </div>
                </div>

                <div class="doc-list">
                    <h3>Informaci√≥n Personal</h3>
                    <div style="background: white; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            ${Object.entries(appState.personalInfo).map(([key, value]) => `
                                <div>
                                    <strong style="color: var(--warm-gray); font-size: 0.85rem; display: block; margin-bottom: 0.25rem;">
                                        ${getFieldLabel(key)}
                                    </strong>
                                    <span>${value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <h3>Motivo del Viaje</h3>
                    <div style="background: white; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem;">
                        ${appState.travelPurpose.travelPurpose ? `
                            <div style="margin-bottom: 1.5rem;">
                                <strong style="color: var(--terracota-dark); display: block; margin-bottom: 0.5rem;">Carta de Motivaci√≥n:</strong>
                                <p style="white-space: pre-wrap; line-height: 1.8; padding: 1rem; background: var(--cream); border-radius: 8px;">${appState.travelPurpose.travelPurpose}</p>
                            </div>
                        ` : ''}
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            ${Object.entries(appState.travelPurpose).filter(([key]) => key !== 'travelPurpose').map(([key, value]) => `
                                <div>
                                    <strong style="color: var(--warm-gray); font-size: 0.85rem; display: block; margin-bottom: 0.25rem;">
                                        ${getTravelFieldLabel(key)}
                                    </strong>
                                    <span>${value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <h3>Documentos Subidos</h3>
                    <div style="background: white; padding: 1.5rem; border-radius: 10px;">
                        ${Object.entries(appState.uploadedFiles).map(([docId, file]) => {
                            if (file === 'N/A') {
                                return `
                                    <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-bottom: 1px solid var(--terracota-pale);">
                                        <span style="color: #94A3B8; font-size: 1.25rem;">üö´</span>
                                        <div>
                                            <strong style="display: block;">${getDocumentTitle(docId)}</strong>
                                            <span style="font-size: 0.85rem; color: #94A3B8;">No Aplica</span>
                                        </div>
                                    </div>
                                `;
                            } else {
                                return `
                                    <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; border-bottom: 1px solid var(--terracota-pale);">
                                        <span style="color: #4CAF50; font-size: 1.25rem;">‚úÖ</span>
                                        <div>
                                            <strong style="display: block;">${getDocumentTitle(docId)}</strong>
                                            <span style="font-size: 0.85rem; color: var(--warm-gray);">${file.name} (${formatFileSize(file.size)})</span>
                                        </div>
                                    </div>
                                `;
                            }
                        }).join('')}
                    </div>
                </div>
            `;
            
            reviewContainer.innerHTML = html;
            
            // Fill confirmation fields
            document.getElementById('confirmName').value = `${appState.personalInfo.firstName || ''} ${appState.personalInfo.lastName || ''}`;
            document.getElementById('confirmEmail').value = appState.personalInfo.email || '';
            document.getElementById('confirmPhone').value = appState.personalInfo.phone || '';
        }

        // Download Checklist for Specific Type (from welcome page) - GENERATES REAL PDF
        function downloadChecklistForType(applicationType) {
            const docs = documentRequirements[applicationType];
            if (!docs || docs.length === 0) {
                alert('Error: No se pudieron cargar los documentos para este tipo de solicitud.');
                return;
            }
            
            // Show loading
            const loadingMsg = document.createElement('div');
            loadingMsg.id = 'pdfLoading';
            loadingMsg.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 2rem 3rem; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); z-index: 10000; text-align: center;';
            loadingMsg.innerHTML = `
                <div style="font-size: 3rem; margin-bottom: 1rem;">üìÑ</div>
                <h3 style="margin: 0 0 0.5rem 0; color: #20B2AA;">Generando PDF...</h3>
                <p style="margin: 0; color: #666;">Por favor espere</p>
            `;
            document.body.appendChild(loadingMsg);
            
            // Generate PDF after brief delay to show loading
            setTimeout(() => {
                try {
                    generatePDFChecklist(applicationType, docs);
                } catch (error) {
                    console.error('Error generating PDF:', error);
                    alert('Error al generar el PDF. Por favor, intente nuevamente.');
                } finally {
                    document.body.removeChild(loadingMsg);
                }
            }, 300);
        }
        
        // Generate PDF Checklist
        function generatePDFChecklist(applicationType, docs) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 20;
            const contentWidth = pageWidth - (margin * 2);
            let yPosition = margin;
            
            const today = new Date().toLocaleDateString('es-ES', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            // Helper function to add new page if needed
            function checkPageBreak(neededSpace) {
                if (yPosition + neededSpace > pageHeight - margin) {
                    doc.addPage();
                    yPosition = margin;
                    return true;
                }
                return false;
            }
            
            // Helper function to draw checkbox
            function drawCheckbox(x, y, size = 6) {
                doc.setDrawColor(32, 178, 170); // Aquamarina
                doc.setLineWidth(0.8);
                doc.rect(x, y - size + 1, size, size);
            }
            
            // ===== HEADER =====
            // Title
            doc.setFillColor(32, 178, 170);
            doc.rect(0, 0, pageWidth, 35, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.setFont('helvetica', 'bold');
            doc.text('üçÅ LMBI IMMIGRATION', pageWidth / 2, 15, { align: 'center' });
            
            doc.setFontSize(16);
            doc.text('Checklist de Documentos Requeridos', pageWidth / 2, 25, { align: 'center' });
            
            yPosition = 45;
            
            // Subtitle
            doc.setTextColor(100, 100, 100);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text('Visa de Turismo Canadiense', pageWidth / 2, yPosition, { align: 'center' });
            yPosition += 5;
            
            doc.setFontSize(9);
            doc.text(`Fecha de generaci√≥n: ${today}`, pageWidth / 2, yPosition, { align: 'center' });
            yPosition += 15;
            
            // Application Type Box
            doc.setFillColor(255, 248, 225);
            doc.setDrawColor(255, 183, 77);
            doc.setLineWidth(0.5);
            doc.rect(margin, yPosition, contentWidth, 12, 'FD');
            
            doc.setTextColor(230, 81, 0);
            doc.setFontSize(11);
            doc.setFont('helvetica', 'bold');
            doc.text(`Tipo de Solicitud: ${getApplicationTypeName(applicationType)}`, margin + 5, yPosition + 8);
            yPosition += 20;
            
            // ===== INSTRUCTIONS BOX =====
            checkPageBreak(45);
            
            doc.setFillColor(227, 242, 253);
            doc.setDrawColor(33, 150, 243);
            doc.setLineWidth(1);
            doc.rect(margin, yPosition, contentWidth, 40, 'FD');
            
            doc.setTextColor(21, 101, 192);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('üìã Instrucciones Importantes', margin + 5, yPosition + 7);
            
            doc.setTextColor(51, 51, 51);
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            const instructions = [
                '‚Ä¢ Idioma: Todos los documentos que no est√©n en franc√©s o ingl√©s deben estar traducidos.',
                '‚Ä¢ Formato: Los documentos deben estar en formato PDF (m√°ximo 3.8 MB por archivo).',
                '‚Ä¢ Fotograf√≠a: Puede estar en formato PDF o JPG/JPEG.',
                '‚Ä¢ Marque cada documento: Use las casillas ‚òë para marcar cuando tenga cada documento listo.'
            ];
            
            instructions.forEach((instruction, index) => {
                doc.text(instruction, margin + 5, yPosition + 15 + (index * 6), { maxWidth: contentWidth - 10 });
            });
            
            yPosition += 48;
            
            // ===== DOCUMENTS BY CATEGORY =====
            const obligatorios = docs.filter(d => d.badge === 'Obligatorio');
            const siAplica = docs.filter(d => d.badge === 'Si Aplica');
            const opcionales = docs.filter(d => d.badge === 'Opcional');
            
            // Function to add category
            function addCategory(title, documents, color) {
                checkPageBreak(20);
                
                // Category header
                const [r, g, b] = color;
                doc.setFillColor(r, g, b);
                doc.rect(margin, yPosition, contentWidth, 10, 'F');
                
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(12);
                doc.setFont('helvetica', 'bold');
                doc.text(title, margin + 5, yPosition + 7);
                yPosition += 15;
                
                // Documents
                documents.forEach((document, index) => {
                    const docHeight = 35; // Approximate height per document
                    checkPageBreak(docHeight);
                    
                    // Document box
                    doc.setDrawColor(...color);
                    doc.setLineWidth(0.8);
                    doc.rect(margin, yPosition, contentWidth, docHeight - 3);
                    
                    // Checkbox
                    drawCheckbox(margin + 3, yPosition + 8);
                    
                    // Document number and title
                    doc.setTextColor(...color);
                    doc.setFontSize(11);
                    doc.setFont('helvetica', 'bold');
                    doc.text(`${index + 1}. ${document.title}`, margin + 12, yPosition + 7, { maxWidth: contentWidth - 15 });
                    
                    // Description box
                    doc.setFillColor(245, 245, 245);
                    doc.setDrawColor(200, 200, 200);
                    doc.setLineWidth(0.3);
                    doc.rect(margin + 3, yPosition + 10, contentWidth - 6, 15, 'FD');
                    
                    doc.setTextColor(51, 51, 51);
                    doc.setFontSize(8);
                    doc.setFont('helvetica', 'normal');
                    const splitDescription = doc.splitTextToSize(document.description, contentWidth - 12);
                    doc.text(splitDescription.slice(0, 3), margin + 5, yPosition + 14); // Max 3 lines
                    
                    // Format info
                    doc.setFillColor(230, 255, 250);
                    doc.rect(margin + 3, yPosition + 26, contentWidth - 6, 5, 'F');
                    
                    doc.setTextColor(23, 143, 135);
                    doc.setFontSize(7);
                    doc.setFont('helvetica', 'bold');
                    const formatText = document.id === 'photo' ? 
                        'Formato: PDF (m√°x. 3.8 MB) | JPG/JPEG tambi√©n aceptado' : 
                        'Formato: PDF (m√°x. 3.8 MB)';
                    doc.text(formatText, margin + 5, yPosition + 29);
                    
                    yPosition += docHeight;
                });
            }
            
            // Add Obligatorios
            if (obligatorios.length > 0) {
                addCategory(`‚úÖ DOCUMENTOS OBLIGATORIOS (${obligatorios.length})`, obligatorios, [32, 178, 170]);
            }
            
            // Add Si Aplica
            if (siAplica.length > 0) {
                addCategory(`‚ö†Ô∏è DOCUMENTOS CONDICIONALES (${siAplica.length})`, siAplica, [245, 158, 11]);
            }
            
            // Add Opcionales
            if (opcionales.length > 0) {
                addCategory(`‚ÑπÔ∏è DOCUMENTOS OPCIONALES (${opcionales.length})`, opcionales, [148, 163, 184]);
            }
            
            // ===== SUMMARY BOX =====
            checkPageBreak(35);
            
            doc.setFillColor(232, 245, 233);
            doc.setDrawColor(76, 175, 80);
            doc.setLineWidth(1);
            doc.rect(margin, yPosition, contentWidth, 30, 'FD');
            
            doc.setTextColor(46, 125, 50);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('üìä Resumen de Documentos', margin + 5, yPosition + 7);
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            let summaryY = yPosition + 15;
            
            if (obligatorios.length > 0) {
                doc.text(`‚úÖ Obligatorios:`, margin + 5, summaryY);
                doc.setFont('helvetica', 'bold');
                doc.text(`${obligatorios.length}`, contentWidth - 10, summaryY, { align: 'right' });
                summaryY += 5;
            }
            
            if (siAplica.length > 0) {
                doc.setFont('helvetica', 'normal');
                doc.text(`‚ö†Ô∏è Si Aplica:`, margin + 5, summaryY);
                doc.setFont('helvetica', 'bold');
                doc.text(`${siAplica.length}`, contentWidth - 10, summaryY, { align: 'right' });
                summaryY += 5;
            }
            
            if (opcionales.length > 0) {
                doc.setFont('helvetica', 'normal');
                doc.text(`‚ÑπÔ∏è Opcionales:`, margin + 5, summaryY);
                doc.setFont('helvetica', 'bold');
                doc.text(`${opcionales.length}`, contentWidth - 10, summaryY, { align: 'right' });
                summaryY += 5;
            }
            
            doc.setLineWidth(0.5);
            doc.line(margin + 5, summaryY, contentWidth - 5, summaryY);
            summaryY += 4;
            
            doc.setFontSize(11);
            doc.text('TOTAL:', margin + 5, summaryY);
            doc.setFont('helvetica', 'bold');
            doc.text(`${docs.length}`, contentWidth - 10, summaryY, { align: 'right' });
            
            yPosition += 38;
            
            // ===== CONTACT BOX =====
            checkPageBreak(30);
            
            doc.setFillColor(227, 242, 253);
            doc.setDrawColor(33, 150, 243);
            doc.setLineWidth(1);
            doc.rect(margin, yPosition, contentWidth, 25, 'FD');
            
            doc.setTextColor(21, 101, 192);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('üìû Informaci√≥n de Contacto', margin + 5, yPosition + 7);
            
            doc.setTextColor(51, 51, 51);
            doc.setFontSize(9);
            doc.setFont('helvetica', 'bold');
            doc.text('LMBI Immigration', margin + 5, yPosition + 14);
            
            doc.setFont('helvetica', 'normal');
            doc.text('üìß Email: lmbi.immigration@gmail.com', margin + 5, yPosition + 19);
            doc.text('üåê Web: www.lmbi-immigration.com', margin + 80, yPosition + 19);
            
            yPosition += 28;
            
            // Footer note
            checkPageBreak(10);
            doc.setFontSize(7);
            doc.setTextColor(100, 100, 100);
            doc.setFont('helvetica', 'italic');
            const footerText = 'Este checklist es una gu√≠a de referencia. Por favor, verifique siempre los requisitos oficiales en el sitio de IRCC.';
            doc.text(footerText, pageWidth / 2, yPosition, { align: 'center', maxWidth: contentWidth - 20 });
            
            // ===== SAVE PDF =====
            const typeNames = {
                'adult-outside': 'Adulto_Fuera_Canada',
                'adult-inside': 'Adulto_Dentro_Canada',
                'child': 'Menor_Edad'
            };
            
            const fileName = `LMBI_Checklist_${typeNames[applicationType]}_${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(fileName);
        }
        
        // Print Checklist (from Step 2) - Still uses print dialog
        function printChecklist() {
            const docs = documentRequirements[appState.applicationType];
            if (!docs || docs.length === 0) {
                alert('Por favor, primero seleccione su tipo de solicitud en el Paso 1.');
                return;
            }
            
            generateAndPrintChecklist();
        }
        
        // Generate and Print Checklist (shared function)
        function generateAndPrintChecklist() {
            const docs = documentRequirements[appState.applicationType];
            if (!docs || docs.length === 0) {
                alert('Por favor, primero seleccione su tipo de solicitud en el Paso 1.');
                return;
            }
            
            const today = new Date().toLocaleDateString('es-ES', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            let checklistHTML = `
                <div style="font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; background: white;">
                    <div style="text-align: center; margin-bottom: 3rem; border-bottom: 4px solid #20B2AA; padding-bottom: 2rem;">
                        <h1 style="font-family: 'Montserrat', sans-serif; color: #20B2AA; margin-bottom: 0.5rem; font-size: 2.5rem; font-weight: 900; text-transform: uppercase; letter-spacing: 2px;">üçÅ LMBI IMMIGRATION</h1>
                        <h2 style="color: #333; margin: 0.5rem 0; font-size: 1.8rem; font-weight: 700;">Checklist de Documentos Requeridos</h2>
                        <p style="color: #666; margin-top: 1rem; font-size: 1.1rem; font-weight: 500;">Visa de Turismo Canadiense</p>
                        <p style="color: #888; font-size: 0.95rem; margin-top: 0.5rem;">Fecha de impresi√≥n: ${today}</p>
                    </div>
                    
                    <div style="background: #FFF8E1; padding: 1.5rem; border-left: 5px solid #FFB74D; margin-bottom: 3rem; border-radius: 4px;">
                        <p style="margin: 0; color: #E65100; font-size: 1.1rem; font-weight: 600;">
                            <strong>Tipo de Solicitud:</strong> ${getApplicationTypeName()}
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 3rem; background: #E3F2FD; padding: 1.5rem; border-radius: 8px; border-left: 5px solid #2196F3;">
                        <h3 style="color: #1565C0; margin-top: 0; margin-bottom: 1rem; font-size: 1.3rem;">
                            üìã Instrucciones Importantes
                        </h3>
                        <ul style="line-height: 2; color: #333; margin: 0; padding-left: 1.5rem;">
                            <li style="margin-bottom: 0.8rem;"><strong>Idioma:</strong> Todos los documentos que no est√©n en franc√©s o ingl√©s deben estar traducidos por un traductor certificado.</li>
                            <li style="margin-bottom: 0.8rem;"><strong>Formato:</strong> Los documentos deben estar en formato PDF con un tama√±o m√°ximo de 3.8 MB por archivo.</li>
                            <li style="margin-bottom: 0.8rem;"><strong>Fotograf√≠a:</strong> Puede estar en formato PDF o JPG/JPEG.</li>
                            <li style="margin-bottom: 0.8rem;"><strong>Originales:</strong> Tenga los documentos originales disponibles para verificaci√≥n.</li>
                            <li><strong>Marque cada documento:</strong> Use las casillas ‚òë para marcar cuando tenga cada documento listo y escaneado.</li>
                        </ul>
                    </div>
            `;
            
            // Agrupar documentos por categor√≠a
            const obligatorios = docs.filter(d => d.badge === 'Obligatorio');
            const opcionales = docs.filter(d => d.badge === 'Opcional');
            const siAplica = docs.filter(d => d.badge === 'Si Aplica');
            
            // Documentos Obligatorios
            if (obligatorios.length > 0) {
                checklistHTML += `
                    <div style="margin-bottom: 3rem; page-break-inside: avoid;">
                        <div style="background: linear-gradient(135deg, #20B2AA, #5FDED6); color: white; padding: 1rem 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; box-shadow: 0 2px 8px rgba(32,178,170,0.3);">
                            <h3 style="margin: 0; font-size: 1.4rem; font-weight: 700;">
                                ‚úÖ Documentos Obligatorios (${obligatorios.length})
                            </h3>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.95rem; opacity: 0.95;">Estos documentos son requeridos para todos los aplicantes</p>
                        </div>
                `;
                
                obligatorios.forEach((doc, index) => {
                    checklistHTML += `
                        <div style="margin-bottom: 2rem; padding: 1.5rem; border: 3px solid #20B2AA; border-radius: 10px; background: white; page-break-inside: avoid; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 40px; vertical-align: top; padding-right: 15px;">
                                        <div style="width: 28px; height: 28px; border: 3px solid #20B2AA; border-radius: 4px; background: white;"></div>
                                    </td>
                                    <td style="vertical-align: top;">
                                        <h4 style="margin: 0 0 1rem 0; color: #20B2AA; font-size: 1.2rem; font-weight: 700;">
                                            ${index + 1}. ${doc.title}
                                        </h4>
                                        <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px; border-left: 4px solid #20B2AA;">
                                            <p style="margin: 0; color: #333; font-size: 0.95rem; line-height: 1.8;">
                                                ${doc.description}
                                            </p>
                                        </div>
                                        <div style="margin-top: 1rem; padding: 0.8rem; background: #E6FFFA; border-radius: 6px;">
                                            <p style="margin: 0; font-size: 0.85rem; color: #178F87;">
                                                <strong>Formato:</strong> PDF (m√°x. 3.8 MB)
                                                ${doc.id === 'photo' ? ' | JPG/JPEG tambi√©n aceptado' : ''}
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    `;
                });
                
                checklistHTML += `</div>`;
            }
            
            // Documentos Si Aplica
            if (siAplica.length > 0) {
                checklistHTML += `
                    <div style="margin-bottom: 3rem; page-break-inside: avoid;">
                        <div style="background: linear-gradient(135deg, #F59E0B, #FCD34D); color: white; padding: 1rem 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; box-shadow: 0 2px 8px rgba(245,158,11,0.3);">
                            <h3 style="margin: 0; font-size: 1.4rem; font-weight: 700;">
                                ‚ö†Ô∏è Documentos Condicionales (${siAplica.length})
                            </h3>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.95rem; opacity: 0.95;">Solo si aplica a su situaci√≥n espec√≠fica</p>
                        </div>
                `;
                
                siAplica.forEach((doc, index) => {
                    checklistHTML += `
                        <div style="margin-bottom: 2rem; padding: 1.5rem; border: 3px solid #F59E0B; border-radius: 10px; background: white; page-break-inside: avoid; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 40px; vertical-align: top; padding-right: 15px;">
                                        <div style="width: 28px; height: 28px; border: 3px solid #F59E0B; border-radius: 4px; background: white;"></div>
                                    </td>
                                    <td style="vertical-align: top;">
                                        <h4 style="margin: 0 0 1rem 0; color: #F59E0B; font-size: 1.2rem; font-weight: 700;">
                                            ${index + 1}. ${doc.title}
                                        </h4>
                                        <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px; border-left: 4px solid #F59E0B;">
                                            <p style="margin: 0; color: #333; font-size: 0.95rem; line-height: 1.8;">
                                                ${doc.description}
                                            </p>
                                        </div>
                                        <div style="margin-top: 1rem; padding: 0.8rem; background: #FFF8E1; border-radius: 6px;">
                                            <p style="margin: 0; font-size: 0.85rem; color: #E65100;">
                                                <strong>Formato:</strong> PDF (m√°x. 3.8 MB)
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    `;
                });
                
                checklistHTML += `</div>`;
            }
            
            // Documentos Opcionales
            if (opcionales.length > 0) {
                checklistHTML += `
                    <div style="margin-bottom: 3rem; page-break-inside: avoid;">
                        <div style="background: linear-gradient(135deg, #94A3B8, #CBD5E1); color: white; padding: 1rem 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; box-shadow: 0 2px 8px rgba(148,163,184,0.3);">
                            <h3 style="margin: 0; font-size: 1.4rem; font-weight: 700;">
                                ‚ÑπÔ∏è Documentos Opcionales (${opcionales.length})
                            </h3>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.95rem; opacity: 0.95;">Recomendados para fortalecer su solicitud</p>
                        </div>
                `;
                
                opcionales.forEach((doc, index) => {
                    checklistHTML += `
                        <div style="margin-bottom: 2rem; padding: 1.5rem; border: 3px solid #94A3B8; border-radius: 10px; background: white; page-break-inside: avoid; box-shadow: 0 2px 6px rgba(0,0,0,0.08);">
                            <table style="width: 100%; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 40px; vertical-align: top; padding-right: 15px;">
                                        <div style="width: 28px; height: 28px; border: 3px solid #94A3B8; border-radius: 4px; background: white;"></div>
                                    </td>
                                    <td style="vertical-align: top;">
                                        <h4 style="margin: 0 0 1rem 0; color: #64748B; font-size: 1.2rem; font-weight: 700;">
                                            ${index + 1}. ${doc.title}
                                        </h4>
                                        <div style="background: #F5F5F5; padding: 1rem; border-radius: 6px; border-left: 4px solid #94A3B8;">
                                            <p style="margin: 0; color: #333; font-size: 0.95rem; line-height: 1.8;">
                                                ${doc.description}
                                            </p>
                                        </div>
                                        <div style="margin-top: 1rem; padding: 0.8rem; background: #F8FAFC; border-radius: 6px;">
                                            <p style="margin: 0; font-size: 0.85rem; color: #475569;">
                                                <strong>Formato:</strong> PDF (m√°x. 3.8 MB)
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    `;
                });
                
                checklistHTML += `</div>`;
            }
            
            // Resumen y notas finales
            checklistHTML += `
                    <div style="margin-top: 4rem; padding: 2rem; background: #E8F5E9; border: 3px solid #4CAF50; border-radius: 10px; page-break-inside: avoid;">
                        <h3 style="color: #2E7D32; margin-top: 0; font-size: 1.3rem; font-weight: 700;">üìä Resumen de Documentos</h3>
                        <table style="width: 100%; margin: 1rem 0;">
                            <tr>
                                <td style="padding: 0.5rem 0; font-weight: 600;">‚úÖ Obligatorios:</td>
                                <td style="padding: 0.5rem 0; text-align: right; font-weight: 700; font-size: 1.1rem; color: #20B2AA;">${obligatorios.length}</td>
                            </tr>
                            ${siAplica.length > 0 ? `
                            <tr>
                                <td style="padding: 0.5rem 0; font-weight: 600;">‚ö†Ô∏è Si Aplica:</td>
                                <td style="padding: 0.5rem 0; text-align: right; font-weight: 700; font-size: 1.1rem; color: #F59E0B;">${siAplica.length}</td>
                            </tr>
                            ` : ''}
                            ${opcionales.length > 0 ? `
                            <tr>
                                <td style="padding: 0.5rem 0; font-weight: 600;">‚ÑπÔ∏è Opcionales:</td>
                                <td style="padding: 0.5rem 0; text-align: right; font-weight: 700; font-size: 1.1rem; color: #94A3B8;">${opcionales.length}</td>
                            </tr>
                            ` : ''}
                            <tr style="border-top: 2px solid #4CAF50;">
                                <td style="padding: 0.8rem 0; font-weight: 700; font-size: 1.1rem;">TOTAL:</td>
                                <td style="padding: 0.8rem 0; text-align: right; font-weight: 900; font-size: 1.3rem; color: #2E7D32;">${docs.length}</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div style="margin-top: 3rem; padding: 2rem; background: linear-gradient(135deg, #E3F2FD, #BBDEFB); border-radius: 10px; border: 2px solid #2196F3;">
                        <h3 style="color: #1565C0; margin-top: 0; font-size: 1.3rem;">üìû Informaci√≥n de Contacto</h3>
                        <p style="margin: 0.8rem 0; color: #333; font-size: 1.05rem; font-weight: 600;">LMBI Immigration</p>
                        <p style="margin: 0.5rem 0; color: #666;">üìß Email: info@lmbi-immigration.com</p>
                        <p style="margin: 0.5rem 0; color: #666;">üåê Web: www.lmbi-immigration.com</p>
                        <p style="margin: 0.5rem 0; color: #666;">üì± WhatsApp: +1 (XXX) XXX-XXXX</p>
                        <hr style="margin: 1.5rem 0; border: none; border-top: 2px solid #2196F3; opacity: 0.3;">
                        <p style="margin: 1rem 0 0 0; color: #666; font-size: 0.9rem; font-style: italic; line-height: 1.6;">
                            <strong>Nota importante:</strong> Este checklist es una gu√≠a de referencia basada en los requisitos actuales de IRCC. 
                            Por favor, verifique siempre los requisitos m√°s recientes en el sitio oficial de Immigration, Refugees and Citizenship Canada (IRCC).
                        </p>
                        <p style="margin: 1rem 0 0 0; color: #888; font-size: 0.85rem; text-align: center;">
                            Documento generado el ${today}
                        </p>
                    </div>
                </div>
            `;
            
            // Insertar en el div oculto y imprimir
            document.getElementById('printableChecklist').innerHTML = checklistHTML;
            window.print();
        }
        
        function getApplicationTypeName() {
            const names = {
                'adult-outside': 'Adulto fuera de Canad√°',
                'adult-inside': 'Adulto dentro de Canad√°',
                'child': 'Ni√±o(a) menor de edad'
            };
            return names[appState.applicationType] || 'No seleccionado';
        }

        // Submit Application
        async function submitApplication() {
            // Validate confirmation form
            const confirmForm = document.getElementById('finalConfirmationForm');
            if (!confirmForm.checkValidity()) {
                confirmForm.reportValidity();
                return;
            }
            
            // Check all checkboxes
            const confirmDocuments = document.getElementById('confirmDocuments');
            const confirmInfo = document.getElementById('confirmInfo');
            const confirmReview = document.getElementById('confirmReview');
            
            if (!confirmDocuments.checked || !confirmInfo.checked || !confirmReview.checked) {
                alert('Por favor, marque todas las casillas de confirmaci√≥n antes de enviar su solicitud.');
                return;
            }
            
            const submitBtn = document.getElementById('submitApplication');
            const loadingEl = document.getElementById('loadingSubmit');
            
            submitBtn.disabled = true;
            loadingEl.classList.add('active');
            
            try {
                // Preparar datos de la solicitud
                const applicationData = {
                    referenceNumber: generateReferenceNumber(),
                    submissionDate: new Date().toISOString(),
                    applicationType: appState.applicationType,
                    personalInfo: appState.personalInfo,
                    travelPurpose: appState.travelPurpose,
                    uploadedFiles: {}
                };
                
                // Preparar archivos para env√≠o
                const formData = new FormData();
                
                // Agregar informaci√≥n de la solicitud como JSON
                formData.append('applicationData', JSON.stringify(applicationData));
                
                // Agregar cada archivo subido
                let fileCount = 0;
                for (const [docId, file] of Object.entries(appState.uploadedFiles)) {
                    if (file !== 'N/A' && file instanceof File) {
                        formData.append(`document_${docId}`, file, file.name);
                        applicationData.uploadedFiles[docId] = file.name;
                        fileCount++;
                    }
                }
                
                console.log('Enviando solicitud con', fileCount, 'documentos...');
                
                // NOTA IMPORTANTE: Esta es una simulaci√≥n
                // Para implementaci√≥n real, necesitas un backend que:
                // 1. Reciba el FormData
                // 2. Procese los archivos
                // 3. Env√≠e el email con attachments usando un servicio como:
                //    - SendGrid
                //    - Nodemailer
                //    - AWS SES
                //    - Mailgun
                
                // Simular env√≠o (reemplazar con llamada real al backend)
                await sendEmailWithAttachments(formData, applicationData);
                
                alert(`‚úÖ Solicitud enviada exitosamente!\n\nN√∫mero de referencia: ${applicationData.referenceNumber}\n\nRecibir√° una confirmaci√≥n en: ${appState.personalInfo.email}\n\nNuestro equipo revisar√° su solicitud en 2-3 d√≠as h√°biles.`);
                
                // Limpiar y recargar
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
                
            } catch (error) {
                console.error('Error al enviar:', error);
                alert('‚ùå Error al enviar la solicitud.\n\nPor favor, intente nuevamente o contacte a soporte:\nlmbi.immigration@gmail.com');
            } finally {
                submitBtn.disabled = false;
                loadingEl.classList.remove('active');
            }
        }
        
        // Funci√≥n para enviar email con archivos adjuntos
        async function sendEmailWithAttachments(formData, applicationData) {
            // IMPORTANTE: Esta es una funci√≥n de ejemplo
            // En producci√≥n, debes implementar un backend que maneje esto
            
            // Ejemplo de c√≥mo se ver√≠a la llamada al backend:
            /*
            const response = await fetch('https://tu-backend.com/api/submit-application', {
                method: 'POST',
                body: formData
            });
            
            if (!response.ok) {
                throw new Error('Error al enviar la solicitud');
            }
            
            return await response.json();
            */
            
            // SIMULACI√ìN (remover en producci√≥n)
            console.log('=== SIMULACI√ìN DE ENV√çO ===');
            console.log('Destino: lmbi.immigration@gmail.com');
            console.log('Referencia:', applicationData.referenceNumber);
            console.log('Aplicante:', applicationData.personalInfo.firstName, applicationData.personalInfo.lastName);
            console.log('Email:', applicationData.personalInfo.email);
            console.log('Tipo:', applicationData.applicationType);
            console.log('Documentos adjuntos:', Object.keys(applicationData.uploadedFiles).length);
            console.log('==============================');
            
            // Simular delay de red
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            // NOTA: Para implementaci√≥n real, ver el c√≥digo de ejemplo en los comentarios abajo
            
            /*
            ========================================
            C√ìDIGO DE BACKEND EJEMPLO (Node.js + Express + Nodemailer)
            ========================================
            
            const express = require('express');
            const multer = require('multer');
            const nodemailer = require('nodemailer');
            const app = express();
            
            // Configurar multer para archivos
            const upload = multer({ 
                storage: multer.memoryStorage(),
                limits: { fileSize: 4 * 1024 * 1024 } // 4MB
            });
            
            // Configurar transporte de email
            const transporter = nodemailer.createTransport({
                service: 'gmail',
                auth: {
                    user: 'tu-email@gmail.com',
                    pass: 'tu-app-password' // Usar App Password de Gmail
                }
            });
            
            app.post('/api/submit-application', upload.any(), async (req, res) => {
                try {
                    const applicationData = JSON.parse(req.body.applicationData);
                    const files = req.files;
                    
                    // Preparar attachments
                    const attachments = files.map(file => ({
                        filename: file.originalname,
                        content: file.buffer
                    }));
                    
                    // Crear email HTML
                    const emailHTML = `
                        <h2>Nueva Solicitud de Visa - ${applicationData.referenceNumber}</h2>
                        <h3>Informaci√≥n del Aplicante:</h3>
                        <ul>
                            <li>Nombre: ${applicationData.personalInfo.firstName} ${applicationData.personalInfo.lastName}</li>
                            <li>Email: ${applicationData.personalInfo.email}</li>
                            <li>Tel√©fono: ${applicationData.personalInfo.phone}</li>
                            <li>Tipo: ${applicationData.applicationType}</li>
                        </ul>
                        <h3>Documentos Adjuntos: ${files.length}</h3>
                        <p>Fecha de env√≠o: ${new Date(applicationData.submissionDate).toLocaleString('es-ES')}</p>
                    `;
                    
                    // Enviar email
                    await transporter.sendMail({
                        from: '"LMBI Immigration Portal" <tu-email@gmail.com>',
                        to: 'lmbi.immigration@gmail.com',
                        subject: `Nueva Solicitud de Visa - ${applicationData.referenceNumber}`,
                        html: emailHTML,
                        attachments: attachments
                    });
                    
                    // Enviar confirmaci√≥n al aplicante
                    await transporter.sendMail({
                        from: '"LMBI Immigration" <lmbi.immigration@gmail.com>',
                        to: applicationData.personalInfo.email,
                        subject: 'Confirmaci√≥n de Solicitud - LMBI Immigration',
                        html: `
                            <h2>Su solicitud ha sido recibida</h2>
                            <p>Estimado/a ${applicationData.personalInfo.firstName},</p>
                            <p>Hemos recibido su solicitud de visa con el n√∫mero de referencia: <strong>${applicationData.referenceNumber}</strong></p>
                            <p>Nuestro equipo la revisar√° en 2-3 d√≠as h√°biles.</p>
                            <p>Saludos cordiales,<br>Equipo LMBI Immigration</p>
                        `
                    });
                    
                    res.json({ success: true, reference: applicationData.referenceNumber });
                    
                } catch (error) {
                    console.error(error);
                    res.status(500).json({ success: false, error: error.message });
                }
            });
            
            app.listen(3000, () => console.log('Server running on port 3000'));
            
            ========================================
            FIN DEL C√ìDIGO DE BACKEND EJEMPLO
            ========================================
            */
        }

        // Helper Functions
        function getFieldLabel(key) {
            const labels = {
                firstName: 'Nombre(s)',
                lastName: 'Apellido(s)',
                birthDate: 'Fecha de Nacimiento',
                birthPlace: 'Lugar de Nacimiento',
                citizenship: 'Ciudadan√≠a',
                passportNumber: 'Pasaporte',
                email: 'Email',
                phone: 'Tel√©fono',
                address: 'Direcci√≥n',
                travelDateStart: 'Fecha Viaje (Ida)',
                travelDateEnd: 'Fecha Viaje (Regreso)',
                travelPurpose: 'Prop√≥sito del Viaje'
            };
            return labels[key] || key;
        }

        function getTravelFieldLabel(key) {
            const labels = {
                estimatedBudget: 'Presupuesto Estimado (CAD)',
                accommodationType: 'Tipo de Alojamiento',
                previousVisits: '¬øHa visitado Canad√° antes?',
                previousVisitsInfo: 'Detalles de visitas anteriores'
            };
            return labels[key] || key;
        }

        function getDocumentTitle(docId) {
            const docs = documentRequirements[appState.applicationType];
            const doc = docs.find(d => d.id === docId);
            return doc ? doc.title : docId;
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        function generateReferenceNumber() {
            const timestamp = Date.now().toString().slice(-8);
            const random = Math.random().toString(36).substring(2, 6).toUpperCase();
            return `LMBI-${timestamp}-${random}`;
        }
    </script>
</body>
</html>